;function defineProperty(target,propertyName,params){params.enumerable=true;params.configurable=true;Object.defineProperty(target,propertyName,params);};function extendClass(parent){return $.extend(true,{},parent);};function extendProperty(target,parent,propertyName){Object.defineProperty(target,propertyName,Object.getOwnPropertyDescriptor(parent,propertyName));};function extendFunction(target,parent,propertyName){target[propertyName]=parent[propertyName];};var ASJS={};var sourcePath="";function sourcePath(value){if(sourcePath!="")return;sourcePath=value;};var includedScript={};function includeOnce(filename){if(includedScript[filename])return;includedScript[filename]=1;$.ajaxSetup({async:false});$.getScript(sourcePath+filename);$.ajaxSetup({async:true});};ASJS.inited;var stage;ASJS.startASJS=function(baseClass){if(ASJS.inited)return;ASJS.inited=true;var dfd=new $.Deferred();$(document).ready(function(){stage=new ASJS.Stage().instance;dfd.resolve(new baseClass());});return dfd.promise();};ASJS.Event=function(type){var that=$.Event(type);return that;};ASJS.Event.CHANGE="change";ASJS.EventDispatcher=function(domElement){var that={};that.dispatchEvent=function(type,data,bubble){bubble=bubble==undefined?true:bubble;if(bubble)that.domObject.trigger(type,data);else that.domObject.triggerHandler(type,data);};that.addEventListener=function(type,callback){that.domObject.on(type,callback);};that.removeEventListeners=function(){that.domObject.off();};that.removeEventListener=function(type,callback){that.domObject.off(type,null,callback);};that.domObject=$(domElement||"<div />");return that;};ASJS.Point=function(x,y){var that={};that.x=x||0;that.y=y||0;return that;};ASJS.MouseEvent=function(type){var that=new ASJS.Event(type);return that;};ASJS.MouseEvent.CLICK="click";ASJS.MouseEvent.MOUSE_DOWN="mousedown";ASJS.MouseEvent.MOUSE_UP="mouseup";ASJS.MouseEvent.MOUSE_LEAVE="mouseleave";ASJS.MouseEvent.MOUSE_MOVE="mousemove";ASJS.MouseEvent.TOUCH_START="touchstart";ASJS.MouseEvent.TOUCH_END="touchend";ASJS.MouseEvent.TOUCH_MOVE="touchmove";ASJS.Mouse=function(){function MouseInstance(){var that={};var _mouseX=0;var _mouseY=0;defineProperty(that,"mouseX",{get:function(){return _mouseX;}});defineProperty(that,"mouseY",{get:function(){return _mouseY;}});that.show=function(){stage.setCSS("cursor","default");};that.hide=function(){stage.setCSS("cursor","none");};that.getRelativePosition=function(value){return value.globalToLocal(new ASJS.Point(that.mouseX,that.mouseY));};(function(){stage.window.on(ASJS.MouseEvent.MOUSE_MOVE,function(event){_mouseX=event.pageX;_mouseY=event.pageY;});})();return that;};defineProperty(this,"instance",{get:function(){if(!ASJS.Mouse.$)ASJS.Mouse.$=new MouseInstance();return ASJS.Mouse.$;}});};ASJS.GeomUtils=function(){var that={};that.pointInOrigo=function(point){return point.x==0&&point.y==0;};that.twoPointDistance=function(pointA,pointB){return Math.sqrt(Math.pow(pointB.x-pointA.x,2)+Math.pow(pointB.y-pointA.y,2));};that.pointInRect=function(point,rect){return point.x>=rect.x&&point.x<=rectangle.x+rect.width&&point.y>=rect.y&&point.y<=rect.y+rect.height;};that.twoPointEquals=function(pointA,pointB){return pointA.x==pointB.x&&pointA.y==pointB.y;};that.rectInRect=function(rectA,rectB){return rectA.x>=rectB.x&&rectA.y==rectB.y&&rectA.x+rectA.width<=rectB.x+rectB.width&&rectA.y+rectA.height<=rectB.y+rectB.height;};return that;};ASJS.GeomUtils.THETA=Math.PI/180;ASJS.DisplayObject=function(domElement){var that=new ASJS.EventDispatcher(domElement);var _rotation=0;var _parent=null;var _cssDisplay="block";defineProperty(that,"id",{get:function(){return that.getAttr("id");},set:function(value){that.setAttr("id",value);}});defineProperty(that,"enabled",{get:function(){return that.getAttr("disabled")!="disabled";},set:function(value){if(value){that.removeAttr("disabled");that.setCSS("pointer-events","auto");}else{that.setAttr("disabled","disabled");that.setCSS("pointer-events","none");}}});defineProperty(that,"display",{get:function(){return _cssDisplay;},set:function(value){_cssDisplay=value;that.setCSS("display",_cssDisplay);}});defineProperty(that,"html",{get:function(){return that.domObject.html();},set:function(value){that.domObject.html(value);}});defineProperty(that,"text",{get:function(){return that.domObject.text();},set:function(value){that.domObject.text(value);}});defineProperty(that,"visible",{get:function(){return that.getCSS("display")!="none";},set:function(value){that.setCSS("display",value?_cssDisplay:"none");}});defineProperty(that,"alpha",{get:function(){return parseFloat(that.getCSS("opacity"));},set:function(value){that.setCSS("opacity",value);}});defineProperty(that,"x",{get:function(){return parseFloat(that.getCSS("left"));},set:function(value){that.setCSS("left",value);}});defineProperty(that,"y",{get:function(){return parseFloat(that.getCSS("top"));},set:function(value){that.setCSS("top",value);}});defineProperty(that,"calcX",{get:function(){return that.x+parseFloat(that.getCSS("marginLeft"));}});defineProperty(that,"calcY",{get:function(){return that.y+parseFloat(that.getCSS("marginTop"));}});defineProperty(that,"right",{get:function(){return parseFloat(that.getCSS("right"));},set:function(value){that.setCSS("right",value);}});defineProperty(that,"bottom",{get:function(){return parseFloat(that.getCSS("bottom"));},set:function(value){that.setCSS("bottom",value);}});defineProperty(that,"width",{get:function(){return that.domObject.width();},set:function(value){that.setCSS("width",value);}});defineProperty(that,"height",{get:function(){return that.domObject.height();},set:function(value){that.setCSS("height",value);}});defineProperty(that,"calcWidth",{get:function(){return that.width+parseFloat(that.getCSS("paddingLeft"))+parseFloat(that.getCSS("paddingRight"));}});defineProperty(that,"calcHeight",{get:function(){return that.height+parseFloat(that.getCSS("paddingTop"))+parseFloat(that.getCSS("paddingBottom"));}});defineProperty(that,"rotation",{get:function(){return _rotation;},set:function(value){_rotation=parseFloat(value);that.setCSS("transform",'rotate('+_rotation+'deg)');}});defineProperty(that,"parent",{get:function(){return _parent;},set:function(value){if(value==null||value.getChildIndex(that)>-1){_parent=value;that.dispatchEvent(that.stage?ASJS.Stage.ADDED_TO_STAGE:ASJS.Stage.REMOVED_FROM_STAGE,null,false);}}});defineProperty(that,"stage",{get:function(){return that.parent?that.parent.stage:null;}});defineProperty(that,"mouseX",{get:function(){return new ASJS.Mouse().instance.getRelativePosition(that).x;}});defineProperty(that,"mouseY",{get:function(){return new ASJS.Mouse().instance.getRelativePosition(that).y;}});defineProperty(that,"domElement",{get:function(){return that.domObject[0];}});that.clear=function(){that.html="";that.text="";};that.getCSS=function(key){return that.domObject.css(key);};that.setCSS=function(key,value){that.domObject.css(key,value);};that.addClass=function(value){return that.domObject.addClass(value);};that.removeClass=function(value){that.domObject.removeClass(value);};that.getAttr=function(key){return that.domObject.attr(key);};that.setAttr=function(key,value){that.domObject.attr(key,value);};that.removeAttr=function(key){that.domObject.removeAttr(key);};that.hitTest=function(point){var rotationDeg=-that.rotation*ASJS.GeomUtils.THETA;var globalPos=that.localToGlobal(new ASJS.Point(0,0));var diffPoint=new ASJS.Point(point.x-(globalPos.x+that.calcWidth*0.5),point.y-(globalPos.y+that.calcHeight*0.5));var rotatedDiffPoint=new ASJS.Point(diffPoint.x*Math.cos(rotationDeg)-diffPoint.y*Math.sin(rotationDeg),diffPoint.x*Math.sin(rotationDeg)+diffPoint.y*Math.cos(rotationDeg));var recalcPoint=new ASJS.Point(point.x-(diffPoint.x-rotatedDiffPoint.x),point.y-(diffPoint.y-rotatedDiffPoint.y));var localPoint=that.globalToLocal(recalcPoint);return localPoint.x>=0&&localPoint.y>=0&&localPoint.x<=that.calcWidth&&localPoint.y<=that.calcHeight;};that.move=function(x,y){that.x=x;that.y=y;};that.setSize=function(w,h){that.width=w;that.height=h;};that.localToGlobal=function(point){if(!point)throw new Error("DisplayObject.localToGlobal: Point is null");var pos=new ASJS.Point(point.x,point.y);var i;var child=that;while(child){pos.x+=child.x||0;pos.y+=child.y||0;child=child.parent;};return pos;};that.globalToLocal=function(point){if(!point)throw new Error("DisplayObject.globalToLocal: Point is null");var pos=new ASJS.Point(point.x,point.y);var i;var child=that;while(child){pos.x-=child.x||0;pos.y-=child.y||0;child=child.parent;};return pos;};that.domObject=$(domElement||"<div />",{tabindex:"-1",style:("pointer-events: auto; position: absolute; display: "+_cssDisplay+"; width: 0px; height: 0px; top: 0px; left: 0px;")});(function(){that.id="intance_"+ASJS.DisplayObject.INSTANCE_ID;ASJS.DisplayObject.INSTANCE_ID++;})();return that;};ASJS.DisplayObject.INSTANCE_ID=0;ASJS.Sprite=function(domElement){var that=new ASJS.DisplayObject(domElement);var _super={};var _children=[];var _mouseChildren=true;defineProperty(that,"mouseChildren",{get:function(){return _mouseChildren;},set:function(value){_mouseChildren=value;var i;var l=that.numChildren;for(i=0;i<l;i++){that.getChildAt(i).enabled=_mouseChildren;}}});defineProperty(that,"numChildren",{get:function(){return _children.length;}});extendFunction(_super,that,"clear");that.clear=function(){while(that.numChildren>0)that.removeChildAt(0);_super.clear();};that.contains=function(child){return that.getChildIndex(child)>-1;};that.addChild=function(child){return that.addChildAt(child,that.numChildren);};that.addChildAt=function(child,index){if(!child)return null;if(child.parent)child.parent.removeChild(child);that.domObject.append(child.domObject);child.enabled=_mouseChildren;_children.push(child);that.setChildIndex(child,index);child.parent=that;return child;};that.removeChild=function(child){if(!child)return null;child.domObject.detach();var index=that.getChildIndex(child);if(index>-1)_children.splice(index,1);child.parent=null;return child;};that.removeChildAt=function(index){return that.removeChild(that.getChildAt(index));};that.getChildAt=function(index){if(index<0||index>that.numChildren-1)return null;return _children[index];};that.setChildIndex=function(child,index){if(!child||index<0)return null;var childActualIndex=that.getChildIndex(child);if(childActualIndex>-1)_children.splice(childActualIndex,1);var afterChild=that.getChildAt(index);if(afterChild)child.domObject.insertBefore(afterChild.domObject);_children.splice(index,0,child);return child;};that.getChildIndex=function(child){if(!child)return-1;return _children.indexOf(child);};that.swapChildren=function(childA,childB){var childAIndex=that.getChildIndex(childA);var childBIndex=that.getChildIndex(childB);if(childAIndex==-1||childBIndex==-1)return false;that.setChildIndex(childA,childBIndex);that.setChildIndex(childB,childAIndex);return true;};that.getChildByDOMObject=function(domObject){if(!domObject)return null;var i;var child;for(i=0;i<that.numChildren;i++){child=that.getChildAt(i);if(domObject.id==child.id)return child;};return null;};return that;};ASJS.Stage=function(){function StageInstance(){var that=new ASJS.Sprite();var _window=$(window);var _head=$("head");that.domObject=$("body");var _stageWidth=0;var _stageHeight=0;defineProperty(that,"title",{get:function(){return document.title;},set:function(value){document.title=value;}});defineProperty(that,"stage",{get:function(){return that;}});defineProperty(that,"stageWidth",{get:function(){return _stageWidth;}});defineProperty(that,"stageHeight",{get:function(){return _stageHeight;}});defineProperty(that,"window",{get:function(){return _window;}});defineProperty(that,"head",{get:function(){return _head;}});function recalcStageSize(){var overflowX=that.getCSS("overflow-x");var overflowY=that.getCSS("overflow-y");that.setCSS("overflow-x","hidden");that.setCSS("overflow-y","hidden");_stageWidth=_window.width();_stageHeight=_window.height();that.setCSS("overflow-x",overflowX);that.setCSS("overflow-y",overflowY);that.dispatchEvent(ASJS.Stage.RESIZE);};(function(){that.clear();that.setSize("100%","100%");_window.resize(function(event){recalcStageSize();});recalcStageSize();})();return that;};defineProperty(this,"instance",{get:function(){if(!ASJS.Stage.$)ASJS.Stage.$=new StageInstance();return ASJS.Stage.$;}});};ASJS.Stage.RESIZE="ASJS-Stage-resize";ASJS.Stage.ADDED_TO_STAGE="ASJS-Stage-addedToStage";ASJS.Stage.REMOVED_FROM_STAGE="ASJS-Stage-removedFromStage";ASJS.NotificationHandler=function(){function NotificationHandlerInstance(){var that={};var _notificationHandlers={};that.register=function(notificationDispatcher){if(!notificationDispatcher.handlers)return;var i;var l=notificationDispatcher.handlers.length;var notificationType;for(i=0;i<l;i++){notificationType=notificationDispatcher.handlers[i];if(!_notificationHandlers[notificationType])_notificationHandlers[notificationType]=[];_notificationHandlers[notificationType].push(notificationDispatcher);}};that.remove=function(notificationDispatcher){if(!notificationDispatcher.handlers)return;var i;var l=notificationDispatcher.handlers?notificationDispatcher.handlers.length:0;var notificationType;for(i=0;i<l;i++){notificationType=notificationDispatcher.handlers[i];if(_notificationHandlers[notificationType]){var index=_notificationHandlers[notificationType].indexOf(notificationDispatcher);if(index>-1)_notificationHandlers[notificationType].splice(index,1);}}};that.sendNotification=function(notificationType,data){var i;var l=_notificationHandlers[notificationType]?_notificationHandlers[notificationType].length:0;var removeHandlers=[];for(i=0;i<l;i++){if(_notificationHandlers[notificationType][i]){_notificationHandlers[notificationType][i].reciveNotification(notificationType,data);}else{_notificationHandlers[notificationType].splice(i,1);l--;}}};return that;};defineProperty(this,"instance",{get:function(){if(!ASJS.NotificationHandler.$)ASJS.NotificationHandler.$=new NotificationHandlerInstance();return ASJS.NotificationHandler.$;}});};ASJS.NotificationDispatcher=function(){var that={};that.handlers=[];that.destruct=function(){that.removeNotificationHandlers();that=null;};that.sendNotification=function(notificationType,data){new ASJS.NotificationHandler().instance.sendNotification(notificationType,data);};that.reciveNotification=function(notificationType,data){};that.registerNotificationHandlers=function(){new ASJS.NotificationHandler().instance.register(that);};that.removeNotificationHandlers=function(){new ASJS.NotificationHandler().instance.remove(that);};return that;};ASJS.AbstractCommand=function(){var that=new ASJS.NotificationDispatcher();that.execute=function(){};return that;};ASJS.LoaderEvent=function(type){var that=new ASJS.Event(type);that.value;return that;};ASJS.LoaderEvent.LOAD="load";ASJS.LoaderEvent.ERROR="error";ASJS.LoaderEvent.ABORT="abort";ASJS.LoaderEvent.LOAD_START="loadstart";ASJS.LoaderEvent.PROGRESS="progress";ASJS.LoaderEvent.LOAD_END="loadend";ASJS.Loader=function(){var that=new ASJS.EventDispatcher();var _url;var _data;var _requestType;var _dataType;var _headers;var _content;defineProperty(that,"url",{get:function(){return _url;}});defineProperty(that,"headers",{get:function(){return _headers;},set:function(value){_headers=value;}});defineProperty(that,"data",{get:function(){return _data;},set:function(value){_data=value;}});defineProperty(that,"requestType",{get:function(){return _requestType;},set:function(value){_requestType=value;}});defineProperty(that,"dataType",{get:function(){return _dataType;},set:function(value){_dataType=value;}});defineProperty(that,"content",{get:function(){return _content;}});that.load=function(url){if(!url)return;_url=url;var requestData={type:_requestType,url:_url,cache:false,contentType:false,crossDomain:true,processData:false,xhrFields:{withCredentials:true,onprogress:onProgress},success:function(data){_content=data;onLoad();},error:function(xhr,textStatus,errorThrown){_content=xhr;onError(xhr);},complete:function(){onLoadEnd();}};if(_dataType)requestData.dataType=_dataType;if(_data)requestData.data=_data;if(_headers)requestData.headers=_headers;$.ajax(requestData);onLoadStart();};function onLoadStart(){dispatch(ASJS.LoaderEvent.LOAD_START);};function onProgress(data){dispatch(ASJS.LoaderEvent.PROGRESS,{total:data.total,loaded:data.loaded});};function onLoad(){dispatch(ASJS.LoaderEvent.LOAD);};function onLoadEnd(){dispatch(ASJS.LoaderEvent.LOAD_END);};function onError(data){dispatch(ASJS.LoaderEvent.ERROR,data);};function dispatch(type,data){var e=new ASJS.LoaderEvent(type);e.value=data;that.dispatchEvent(e);};return that;};ASJS.RequestMethod=function(){var that={};return that;};ASJS.RequestMethod.DELETE="DELETE";ASJS.RequestMethod.GET="GET";ASJS.RequestMethod.HEAD="HEAD";ASJS.RequestMethod.OPTIONS="OPTIONS";ASJS.RequestMethod.POST="POST";ASJS.RequestMethod.PUT="PUT";function AbstractLoaderCommand(){var that=new ASJS.AbstractCommand();that.load=function(url){var dfd=$.Deferred();var loader=new ASJS.Loader();loader.requestType=ASJS.RequestMethod.GET;loader.addEventListener(ASJS.LoaderEvent.LOAD_END,function(event){loader.removeEventListeners();dfd.resolve(loader.content);});loader.addEventListener(ASJS.LoaderEvent.ERROR,function(event){loader.removeEventListeners();throw new Error("Missing: "+loader.url);dfd.reject();});loader.load(url);return dfd.promise();};return that;};function Config(){function ConfigInstance(){var that={};var _data={};defineProperty(that,"data",{get:function(){return _data;},set:function(value){_data=value}});that.get=function(key){return _data&&_data[key]?_data[key]:null;};return that;};defineProperty(this,"instance",{get:function(){if(!Config.$)Config.$=new ConfigInstance();return Config.$;}});};function ConfigLoaderCommand(){var that=new AbstractLoaderCommand();var _config=new Config().instance;that.execute=function(){var dfd=$.Deferred();that.load("json/config.json").done(function(response){_config.data=response;dfd.resolve();});return dfd.promise();};return that;};function Language(){function LanguageInstance(){var that={};var _languageItems={};var _supportedLanguages;var _selectedLanguage;defineProperty(that,"data",{get:function(){return _languageItems;},set:function(value){_supportedLanguages=value.supported_languages;_selectedLanguage=value.default_language;_languageItems=value.elements;}});defineProperty(that,"supportedLanguages",{get:function(){return _supportedLanguages;}});defineProperty(that,"selectedLanguage",{set:function(value){_selectedLanguage=value;},get:function(){return _selectedLanguage;}});that.getText=function(key){return _languageItems[key]!=undefined&&_languageItems[key][that.selectedLanguage]!=undefined?_languageItems[key][that.selectedLanguage]:"";};that.genText=function(str){for(var key in _languageItems)str=str.split("{{"+key+"}}").join(that.getText(key));return str;};return that;};defineProperty(this,"instance",{get:function(){if(!Language.$)Language.$=new LanguageInstance();return Language.$;}});};function LanguageLoaderCommand(){var that=new AbstractLoaderCommand();var _language=new Language().instance;that.execute=function(){var dfd=$.Deferred();that.load("json/language.json").done(function(response){_language.data=response;dfd.resolve();});return dfd.promise();};return that;};function Tools(){function ToolsInstance(){var that={};var _urlParams={};that.replaceText=function(text,data){for(var key in data)text=text.split("{{"+key+"}}").join(data[key]);return text;};that.isValidEmailAddress=function(email){var re=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email);};that.getURLParams=function(param){var url=decodeURIComponent($(location).attr('href')).split("#");if(url[1]==''||url[1]==undefined)return[];var params=url[1].split('&');for(var i=0;i<params.length;i++){line=params[i].split('=');_urlParams[line[0]]=line[1];};return _urlParams[param];};that.createUrlParams=function(params){var url="";for(var key in params){if(url!="")url+="&";url+=key+"="+params[key];};document.location.href='#'+url;that.reload();};that.reload=function(){window.location.reload(true);};return that;};defineProperty(this,"instance",{get:function(){if(!Tools.$)Tools.$=new ToolsInstance();return Tools.$;}});};function Cookies(){function CookiesInstance(){var that={};that.createCookie=function(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*86400000));var expires="; expires="+date.toGMTString();}else var expires="";document.cookie=name+"="+value+expires+"; path=/";try{if(typeof(Storage)!=="undefined")localStorage[name]=value;}catch(event){console.log(event);}};that.readCookie=function(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);};try{if(typeof(Storage)!=="undefined")return localStorage[name];}catch(event){console.log(event);};return null;};that.eraseCookie=function(name){that.createCookie(name,"",-1);try{if(typeof(Storage)!=="undefined")delete localStorage[name];}catch(event){console.log(event);}};return that;};defineProperty(this,"instance",{get:function(){if(!Cookies.$)Cookies.$=new CookiesInstance();return Cookies.$;}});};ASJS.Cycler=function(){function CyclerInstance(){var that={};var _isPlaying=false;var _fps=24;var _interval=getIntervalByFps();var _callbacks=[];var _timeoutId;defineProperty(that,"isPlaying",{get:function(){return _isPlaying;}});defineProperty(that,"fps",{get:function(){return _fps;},set:function(value){_fps=value;_interval=getIntervalByFps();that.start();}});that.addCallback=function(callback){if(that.callbackExists(callback))return;_callbacks.push(callback);};that.removeCallback=function(callback){if(!that.callbackExists(callback))return;var i;var l=_callbacks.length;var index;for(i=0;i<l;i++){if(_callbacks[i]==callback)index=i;};_callbacks.splice(index,1);};that.callbackExists=function(callback){var i;var l=_callbacks.length;for(i=0;i<l;i++){if(_callbacks[i]==callback)return true;};return false;};that.start=function(){_isPlaying=true;tick();};that.stop=function(){_isPlaying=false;window.clearTimeout(_timeoutId);};function tick(){window.clearTimeout(_timeoutId);var i;var l=_callbacks.length;for(i=0;i<l;i++){if(_callbacks[i])_callbacks[i]();};_timeoutId=window.setTimeout(function(){tick();},_interval);};function getIntervalByFps(){return 1000/_fps;};return that;};defineProperty(this,"instance",{get:function(){if(!ASJS.Cycler.$)ASJS.Cycler.$=new CyclerInstance();return ASJS.Cycler.$;}});};function MobileUtils(){function MobileUtilsInstance(){var that={};var _baseWidth=0;defineProperty(that,"baseWidth",{set:function(value){_baseWidth=value;},get:function(){return _baseWidth;}});that.getOrientation=function(){return stage.stageWidth>stage.stageHeight?MobileUtils.ORIENTATION_LANDSCAPE:MobileUtils.ORIENTATION_PORTRAIT;};that.getScreenWidth=function(fixedPortrait){return fixedPortrait?Math.min(stage.stageWidth,stage.stageHeight):stage.stageWidth;};that.getRatio=function(fixedPortrait){return that.getScreenWidth(fixedPortrait)/that.baseWidth;};that.convertRatio=function(value,fixedPortrait){return that.getRatio(fixedPortrait)*value;};that.preventMobileScrolling=function(){stage.addEventListener(ASJS.MouseEvent.TOUCH_MOVE,function(e){e.preventDefault();});};return that;};defineProperty(this,"instance",{get:function(){if(!MobileUtils.$)MobileUtils.$=new MobileUtilsInstance();return MobileUtils.$;}});};MobileUtils.ORIENTATION_LANDSCAPE="MobileUtils-orientationLandscape";MobileUtils.ORIENTATION_PORTRAIT="MobileUtils-orientationPortrait";function DateUtil(){var that={};(function(){Date.prototype.toYMD=Date_toYMD;function Date_toYMD(){var year=String(this.getFullYear());var month=String(this.getMonth()+1);if(month.length==1)month="0"+month;var day=String(this.getDate());if(day.length==1)day="0"+day;return year+"-"+month+"-"+day;}})();return that;};function EnvironmentCommand(){var that=new ASJS.AbstractCommand();var _language=new Language().instance;var _cookies=new Cookies().instance;var _tools=new Tools().instance;var _cycler=new ASJS.Cycler().instance;var _config=new Config().instance;var _mobileUtils=new MobileUtils().instance;var _sleepToResizeId;that.execute=function(){var selectedLanguage=_tools.getURLParams('lang');if(selectedLanguage==undefined||_language.supportedLanguages.indexOf(selectedLanguage)==-1)selectedLanguage=_cookies.readCookie('language');if(selectedLanguage==undefined||_language.supportedLanguages.indexOf(selectedLanguage)==-1)selectedLanguage=_language.selectedLanguage;_language.selectedLanguage=selectedLanguage;_cookies.createCookie('language',_language.selectedLanguage);stage.title=_language.getText("title");_cycler.fps=_config.get("fps");_cycler.start();_mobileUtils.baseWidth=_config.get("baseWidth");var _dateUtil=new DateUtil();stage.addEventListener(ASJS.Stage.RESIZE,function(event){window.clearTimeout(_sleepToResizeId);_sleepToResizeId=window.setTimeout(function(){that.sendNotification(ASJS.Stage.RESIZE);window.clearTimeout(_sleepToResizeId);},_config.get("resizeInterval"));});};return that;};ASJS.AbstractMediator=function(view){var that=new ASJS.NotificationDispatcher();(function(){that.view=view;})();return that;};ASJS.Cell=function(domElement){var that=new ASJS.Sprite(domElement);var _data={};var _checked=false;defineProperty(that,"name",{get:function(){return that.getAttr("name");},set:function(value){that.setAttr("name",value);}});defineProperty(that,"checked",{get:function(){return _checked;},set:function(value){_checked=value;}});defineProperty(that,"data",{get:function(){return _data;},set:function(value){_data=value;if(_data.id)that.id=_data.id;that.showData();}});that.drawNow=function(){};that.showData=function(){};(function(){that.mouseChildren=false;that.addEventListener(ASJS.MouseEvent.CLICK,function(event){var e=new ASJS.MouseEvent(ASJS.Cell.CLICK);e.ctrlKey=event.ctrlKey;e.shiftKey=event.shiftKey;that.dispatchEvent(e);});})();return that;};ASJS.Cell.CLICK="ASJS-Cell-click";ASJS.CustomList=function(){var that=new ASJS.Sprite();var _name;var _multiselect=false;var _cell=ASJS.Cell;var _listItems=[];var _itemsContainer=new ASJS.Sprite();var _lastCellIndex=0;defineProperty(that,"cell",{get:function(){return _cell;},set:function(value){_cell=value;}});defineProperty(that,"multiselect",{get:function(){return _multiselect;},set:function(value){_multiselect=value;}});defineProperty(that,"selected",{get:function(){var value=[];var i;var item;var l=_itemsContainer.numChildren;for(i=0;i<l;i++){item=_itemsContainer.getChildAt(i);if(item.checked)value.push(item);};return value;},set:function(value){that.clearSelection();var i;var j;var item;var l=_itemsContainer.numChildren;var valueLength=that.multiselect?value.length:1;for(j=0;j<valueLength;j++){for(i=0;i<l;i++){item=_itemsContainer.getChildAt(i);if(i==value[j]){item.checked=true;}}}}});defineProperty(that,"name",{get:function(){return _name;},set:function(value){_name=value;var i;var item;var l=_itemsContainer.numChildren;for(i=0;i<l;i++){item=_itemsContainer.getChildAt(i);item.name=_name;}}});that.clearSelection=function(){var i;var item;var l=_itemsContainer.numChildren;for(i=0;i<l;i++){item=_itemsContainer.getChildAt(i);item.checked=false;}};that.clearList=function(){while(_itemsContainer.numChildren>0)_itemsContainer.removeChildAt(0);};that.setList=function(cellDataVoList){that.clearList();_listItems=cellDataVoList;var i;var l=_listItems.length;for(i=0;i<l;i++){that.addItem(_listItems[i]);}};that.getItemAt=function(index){return _itemsContainer.getChildAt(index).data;};that.getItemById=function(id){var data;var i;var item;var l=_itemsContainer.numChildren;for(i=0;i<l;i++){item=_itemsContainer.getChildAt(i);if(item.id==id)data=item.data;};return data;};that.addItem=function(cellDataVo){var cell=new _cell();cell.name=_name;cell.data=cellDataVo;return _itemsContainer.addChild(cell);};that.addItemAt=function(cellDataVo,index){var cell=that.addItem(cellDataVo);_itemsContainer.setChildIndex(cell,index);return cell;};that.drawNow=function(){_itemsContainer.setSize(that.width,that.height);var i;var l=_itemsContainer.numChildren;var cell;var height=0;for(i=0;i<l;i++){cell=_itemsContainer.getChildAt(i);cell.drawNow();height+=cell.calcHeight;};_itemsContainer.height=height;};function onCellClick(event){var cell=_itemsContainer.getChildByDOMObject(event.target);if(!cell)return;if(!that.multiselect||(!event.ctrlKey&&!event.shiftKey))that.clearSelection();cell.checked=event.ctrlKey?!cell.checked:true;var cellIndex=_itemsContainer.getChildIndex(cell);if(!event.ctrlKey&&event.shiftKey){var i;var l=Math.abs(cellIndex-_lastCellIndex);var step=cellIndex>_lastCellIndex?-1:1;for(i=0;i<l;i++){cell=_itemsContainer.getChildAt(cellIndex+(i*step));cell.checked=true;}};_lastCellIndex=cellIndex;that.dispatchEvent(ASJS.CustomList.CHANGE);};(function(){_itemsContainer.addEventListener(ASJS.Cell.CLICK,onCellClick);that.addChild(_itemsContainer);})();return that;};ASJS.CustomList.CHANGE="ASJS-CustomList-change";ASJS.FormElement=function(domElement){var that=new ASJS.Sprite(domElement);defineProperty(that,"name",{get:function(){return that.getAttr("name");},set:function(value){that.setAttr("name",value);}});that.drawNow=function(){};(function(){that.setAttr("tabindex","auto");})();return that;};ASJS.KeyboardEvent=function(type){var that=new ASJS.Event(type);return that;};ASJS.KeyboardEvent.KEY_UP="keyup";ASJS.KeyboardEvent.KEY_DOWN="keydown";ASJS.KeyboardEvent.KEY_PRESS="keypress";ASJS.AbstractTextElement=function(domElement){var that=new ASJS.FormElement(domElement);var _super={};var _protectedChars={37:true,38:true,39:true,40:true,8:true,9:true,46:true,13:true,16:true,17:true,35:true,36:true,20:true,27:true};var _controlChars={65:true,67:true,86:true,88:true,97:true,99:true,118:true,120:true};var _restrict;defineProperty(that,"placeholder",{get:function(){return that.getAttr("placeholder");},set:function(value){that.setAttr("placeholder",value);}});defineProperty(that,"val",{get:function(){return that.domObject.val();},set:function(value){that.domObject.val(value);}});defineProperty(that,"maxChar",{get:function(){return that.getAttr("maxLength");},set:function(value){that.setAttr("maxLength",value);}});defineProperty(that,"restrict",{get:function(){return _restrict;},set:function(value){_restrict=value;}});(function(){that.addEventListener(ASJS.KeyboardEvent.KEY_PRESS,function(event){if(_restrict){var charCode=event.which?event.which:event.keyCode;if(_protectedChars[event.keyCode]!=undefined||(event.ctrlKey&&_controlChars[charCode]!=undefined))return;if(!new RegExp(_restrict,"i").test(String.fromCharCode(event.which)))return false;}});that.addEventListener(ASJS.KeyboardEvent.KEY_UP,function(event){var charCode=event.which?event.which:event.keyCode;if(_restrict&&(event.ctrlKey&&_controlChars[charCode]!=undefined)){var regExp=new RegExp("(?!"+_restrict+").","g");that.val=that.val.replace(regExp,'');}});})();return that;};ASJS.TextInput=function(){var that=new ASJS.AbstractTextElement("<input />");defineProperty(that,"type",{get:function(){return that.getAttr("type");},set:function(value){that.setAttr("type",value);}});(function(){that.type=ASJS.TextInput.TYPE_TEXT;})();return that;};ASJS.TextInput.TYPE_TEXT="text";ASJS.TextInput.TYPE_PASSWORD="password";ASJS.TextInput.TYPE_EMAIL="email";ASJS.TextInput.TYPE_NUMBER="number";function TextInput(){var that=new ASJS.TextInput();var _mobileUtils=new MobileUtils().instance;var TI_MAX_WIDTH=319;var TI_MAX_HEIGHT=70;var TI_BORDER_MAX_SIZE=2;var TI_FONT_MAX_SIZE=32;that.drawNow=function(){var tiWidth=_mobileUtils.convertRatio(TI_MAX_WIDTH,true);var tiHeight=_mobileUtils.convertRatio(TI_MAX_HEIGHT,true);var tiBorderSize=_mobileUtils.convertRatio(TI_BORDER_MAX_SIZE,true);var tiFontSize=_mobileUtils.convertRatio(TI_FONT_MAX_SIZE,true);that.setSize(Math.min(tiWidth,TI_MAX_WIDTH),Math.min(tiHeight,TI_MAX_HEIGHT));that.setCSS("font-size",Math.min(tiFontSize,TI_FONT_MAX_SIZE)+"px");that.setCSS("border-width",Math.min(tiBorderSize,TI_BORDER_MAX_SIZE)+"px");};(function(){that.addClass("text_input");})();return that;};ASJS.Button=function(){var that=new ASJS.FormElement("<input />");defineProperty(that,"label",{get:function(){return that.getAttr("value");},set:function(value){that.setAttr("value",value);}});defineProperty(that,"submit",{get:function(){return that.getAttr("type")=="submit";},set:function(value){that.setAttr("type",value?"submit":"button");}});(function(){that.setAttr("type","button");})();return that;};function AbstractView(){var that=new ASJS.Sprite();var _config=new Config().instance;function addedToStage(){that.alpha=0;$(that).stop().animate({alpha:1},{duration:_config.get("fadeInterval")});};(function(){that.addEventListener(ASJS.Stage.ADDED_TO_STAGE,addedToStage);})();return that;};ASJS.Label=function(){var that=new ASJS.DisplayObject();return that;};function Label(){var that=new ASJS.Sprite();var _mobileUtils=new MobileUtils().instance;var ICON_MAX_WIDTH=38;var ICON_MAX_HEIGHT=32;var LABEL_MAX_HEIGHT=46;var LABEL_FONT_MAX_SIZE=26;that._label;that._icon;defineProperty(that,"icon",{set:function(value){that._icon.setCSS("background-image","url("+value+")");}});defineProperty(that,"text",{set:function(value){that._label.text=value;}});that.drawNow=function(){var iconWidth=_mobileUtils.convertRatio(ICON_MAX_WIDTH,true);var iconHeight=_mobileUtils.convertRatio(ICON_MAX_HEIGHT,true);var labelHeight=_mobileUtils.convertRatio(LABEL_MAX_HEIGHT,true);that.height=Math.min(labelHeight,LABEL_MAX_HEIGHT);that._icon.setSize(Math.min(iconWidth,ICON_MAX_WIDTH),Math.min(iconHeight,ICON_MAX_HEIGHT));that._icon.y=(that.height-that._icon.height)*0.5;that._icon.x=that._icon.y;var labelFontSize=_mobileUtils.convertRatio(LABEL_FONT_MAX_SIZE,true);that._label.setCSS("font-size",Math.min(labelFontSize,LABEL_FONT_MAX_SIZE)+"px");that._label.setCSS("line-height",that.height+"px");that._label.move(that._icon.x+that._icon.width+(that.height-Math.min(labelFontSize,LABEL_FONT_MAX_SIZE))*0.5,0);that._label.setSize(that.width-that._label.x*2,that.height);};(function(){that.addClass("label");that._label=new ASJS.Label();that._label.addClass("label_text");that.addChild(that._label);that._icon=new ASJS.DisplayObject();that._icon.addClass("label_icon");that.addChild(that._icon);})();return that;};function StatisticsListCell(){var that=new ASJS.Cell();var _super={};var _language=new Language().instance;var _mobileUtils=new MobileUtils().instance;var CELL_MAX_HEIGHT=60;var TITLE_MAX_HEIGHT=24;var TITLE_FONT_MAX_SIZE=20;var TITLE_MAX_X=20;var TITLE_MAX_Y=10;var LINE_MAX_HEIGHT=10;var LINE_MAX_GAP=10;var _box;var _title;var _lineBg;var _line;defineProperty(that,"title",{get:function(){return _title.text;},set:function(value){_title.text=value;}});that.showData=function(){that.title=that.data.timestamp+" [ "+that.data.calories+_language.getText("calorie_unit")+" ]";_title.removeClass("statistics_list_cell_title_good");_title.removeClass("statistics_list_cell_title_bad");_title.addClass("statistics_list_cell_title_"+(that.data.calories<=that.data.dailyCalories?"good":"bad"));_line.removeClass("statistics_list_cell_line_good");_line.removeClass("statistics_list_cell_line_bad");_line.addClass("statistics_list_cell_line_"+(that.data.calories<=that.data.dailyCalories?"good":"bad"));that.drawNow();};that.drawNow=function(){var cellHeight=_mobileUtils.convertRatio(CELL_MAX_HEIGHT,true);that.setSize("100%",Math.min(cellHeight,CELL_MAX_HEIGHT));var marginSize=_mobileUtils.convertRatio(AbstractInAppView.GAP*0.5,true);var marginCalcSize=Math.min(marginSize,AbstractInAppView.GAP*0.5);that.setCSS("margin-top",marginCalcSize);that.setCSS("margin-bottom",marginCalcSize);_box.setSize(that.width,that.height);var titleHeight=_mobileUtils.convertRatio(TITLE_MAX_HEIGHT,true);var titleFontSize=_mobileUtils.convertRatio(TITLE_FONT_MAX_SIZE,true);var titleX=_mobileUtils.convertRatio(TITLE_MAX_X,true);var titleY=_mobileUtils.convertRatio(TITLE_MAX_Y,true);_title.move(Math.min(titleX,TITLE_MAX_X),Math.min(titleY,TITLE_MAX_Y));_title.width=that.width-_title.x-AbstractInAppView.GAP*2;_title.height=Math.min(titleHeight,TITLE_MAX_HEIGHT);_title.setCSS("line-height",_title.height+"px");_title.setCSS("font-size",Math.min(titleFontSize,TITLE_FONT_MAX_SIZE)+"px");var lineHeight=_mobileUtils.convertRatio(LINE_MAX_HEIGHT,true);var lineCalcHeight=Math.min(lineHeight,LINE_MAX_HEIGHT);var lineGap=_mobileUtils.convertRatio(LINE_MAX_GAP,true);var lineCalcGap=Math.min(lineGap,LINE_MAX_GAP);_lineBg.move(lineCalcGap,that.height-lineCalcGap-lineCalcHeight);_lineBg.setSize(that.width-lineCalcGap*2,lineCalcHeight);_line.move(lineCalcGap,that.height-lineCalcGap-lineCalcHeight);_line.setSize(_lineBg.width*Math.max(0.01,(that.data.calories/that.data.maxCalories)),lineCalcHeight);};(function(){that.addClass("food_list_cell");that.setCSS("position","relative");that.setCSS("float","left");_box=new ASJS.Sprite();_box.addClass("food_list_cell_box");that.addChild(_box);_title=new ASJS.Label();_box.addChild(_title);_lineBg=new ASJS.DisplayObject();_lineBg.addClass("statistics_list_cell_line_bg");_box.addChild(_lineBg);_line=new ASJS.DisplayObject();_box.addChild(_line);that.mouseChildren=true;})();return that;};function StatisticListDataVo(value){var that={};var data=value||{};that.timestamp=data["timestamp"]||null;that.calories=data["calories"]||0;that.dailyCalories=data["calories"]||0;that.maxCalories=data["max_calories"]||0;return that;};function StatisticsView(){var that=new AbstractInAppView();var _super={};var _language=new Language().instance;var _mobileUtils=new MobileUtils().instance;var _statisticsLabel;var _statistics={};var _dailyCalories=0;var _statisticsList;defineProperty(that,"dailyCalories",{get:function(){return _dailyCalories;},set:function(value){_dailyCalories=value;}});defineProperty(that,"statistics",{get:function(){return _statistics;},set:function(value){_statistics=value;var statisticList=[];var statisticData;var maxCalories=0;var l=_statistics.length;var i;for(i=0;i<l;i++){statisticData=new StatisticListDataVo(_statistics[i]);statisticData.dailyCalories=that.dailyCalories;if(maxCalories<statisticData.calories)maxCalories=statisticData.calories;statisticList.push(statisticData);};for(i=0;i<l;i++){statisticData=statisticList[i];statisticData.maxCalories=maxCalories;};_statisticsList.setList(statisticList);}});extendFunction(_super,that,"drawNow");that.drawNow=function(){_super.drawNow();_statisticsLabel.move(0,AbstractInAppView.GAP);_statisticsLabel.setSize(that._container.width,that._container.height);_statisticsLabel.drawNow();_statisticsList.move(0,_statisticsLabel.y+_statisticsLabel.calcHeight+AbstractInAppView.GAP);_statisticsList.width=that._container.width;_statisticsList.drawNow();_statisticsList.height=_statisticsList.getChildAt(0).calcHeight+AbstractInAppView.GAP*2;};function removedFromStage(){_statisticsList.clearList();};(function(){that.addEventListener(ASJS.Stage.REMOVED_FROM_STAGE,removedFromStage);_statisticsLabel=new Label();_statisticsLabel.text=_language.getText("statistics_label");_statisticsLabel.icon="images/icons/statistics.png";that._container.addChild(_statisticsLabel);_statisticsList=new ASJS.CustomList();_statisticsList.cell=StatisticsListCell;that._container.addChild(_statisticsList);})();return that;};function Services(){function ServicesInstance(){var that={};var _config=new Config().instance;that.login=function(facebookData,callback,errorCallback){load("login",facebookData,ASJS.RequestMethod.POST,callback,errorCallback);};that.status=function(callback,errorCallback){load("status",null,ASJS.RequestMethod.GET,callback,errorCallback);};that.logout=function(callback,errorCallback){load("logout",null,ASJS.RequestMethod.GET,callback,errorCallback);};that.getFoodList=function(callback,errorCallback){load("food",null,ASJS.RequestMethod.GET,callback,errorCallback);};that.getFoodById=function(foodId,callback,errorCallback){load("food/"+foodId,null,ASJS.RequestMethod.GET,callback,errorCallback);};that.addFood=function(foodData,callback,errorCallback){load("food",foodData,ASJS.RequestMethod.POST,callback,errorCallback);};that.deleteFoodById=function(foodId,callback,errorCallback){load("food/"+foodId,null,ASJS.RequestMethod.DELETE,callback,errorCallback);};that.getCaloriesList=function(callback,errorCallback){load("calories",null,ASJS.RequestMethod.GET,callback,errorCallback);};that.addCalorie=function(calorieData,callback,errorCallback){load("calories",calorieData,ASJS.RequestMethod.POST,callback,errorCallback);};that.deleteCalorieById=function(calorieId,callback,errorCallback){load("calories/"+calorieId,null,ASJS.RequestMethod.DELETE,callback,errorCallback);};that.getStatistics=function(statisticData,callback,errorCallback){load("statistics",statisticData,ASJS.RequestMethod.POST,callback,errorCallback);};that.getSettings=function(callback,errorCallback){load("settings",null,ASJS.RequestMethod.GET,callback,errorCallback);};that.setSettings=function(settingsData,callback,errorCallback){load("settings",settingsData,ASJS.RequestMethod.PUT,callback,errorCallback);};function parseResponse(response){try{return JSON.parse(response);}catch(e){};return response;};function load(url,data,method,callback,errorCallback){var loader=new ASJS.Loader();setUpLoader(loader,method,callback,errorCallback);loader.dataType="json";if(data)loader.data=JSON.stringify(data);loader.load(_config.get("backendURL")+url);};function setUpLoader(loader,method,callback,errorCallback){loader.addEventListener(ASJS.LoaderEvent.LOAD,function(event){onLoadHandler(loader,callback,errorCallback,errorCallback);});loader.addEventListener(ASJS.LoaderEvent.ERROR,function(event){onErrorHandler(loader,errorCallback);});loader.addEventListener(ASJS.LoaderEvent.PROGRESS,function(event){});loader.requestType=method;};function onLoadHandler(loader,callback,errorCallback){loader.removeEventListeners();var response=parseResponse(loader.content);callback(response);};function onErrorHandler(loader,errorCallback){loader.removeEventListeners();var response=parseResponse(loader.content);errorCallback(response,response.status);};return that;};defineProperty(this,"instance",{get:function(){if(!Services.$)Services.$=new ServicesInstance();return Services.$;}});};function QuickNotificationView(){var that=new AbstractView();var _mobileUtils=new MobileUtils().instance;var QN_MAX_HEIGHT=70;var QN_MAX_FONT_SIZE=24;defineProperty(that,"type",{set:function(value){that.removeClass("quick_notification_type_warning");that.removeClass("quick_notification_type_success");that.removeClass("quick_notification_type_message");switch(value){case QuickNotificationMediator.TYPE_WARNING:that.addClass("quick_notification_type_warning");break;case QuickNotificationMediator.TYPE_SUCCESS:that.addClass("quick_notification_type_success");break;default:that.addClass("quick_notification_type_message");break;}}});defineProperty(that,"message",{set:function(value){that.text=value;}});that.drawNow=function(){var qnHeight=_mobileUtils.convertRatio(QN_MAX_HEIGHT,true);var qnFontSize=_mobileUtils.convertRatio(QN_MAX_FONT_SIZE,true);that.setSize(stage.stageWidth,Math.min(qnHeight,QN_MAX_HEIGHT));that.setCSS("font-size",Math.min(qnFontSize,QN_MAX_FONT_SIZE)+"px");that.setCSS("line-height",that.height+"px");that.move(0,stage.stageHeight-that.height);};(function(){that.setCSS("position","fixed");})();return that;};function QuickNotificationMediator(view){var that=new ASJS.AbstractMediator(view);var _config=new Config().instance;var _quickNotificationView=new QuickNotificationView();var _quickNotificationTimeout;that.handlers=[QuickNotificationMediator.SHOW];that.reciveNotification=function(notificationType,data){switch(notificationType){case QuickNotificationMediator.SHOW:onShow(data.message,data.type);break;}};function onShow(message,type){window.clearTimeout(_quickNotificationTimeout);_quickNotificationView.type=type;_quickNotificationView.message=message;if(!that.view.contains(_quickNotificationView))that.view.addChild(_quickNotificationView);_quickNotificationView.drawNow();_quickNotificationTimeout=window.setTimeout(onHide,_config.get("quickNotificationTimeout"));};function onHide(){if(that.view.contains(_quickNotificationView))that.view.removeChild(_quickNotificationView);};(function(){that.registerNotificationHandlers();})();return that;};QuickNotificationMediator.SHOW="QuickNotificationMediator-show";QuickNotificationMediator.TYPE_SUCCESS="QuickNotificationMediator-typeSuccess";QuickNotificationMediator.TYPE_WARNING="QuickNotificationMediator-typeWarning";QuickNotificationMediator.TYPE_MESSAGE="QuickNotificationMediator-typeMessage";function QuickNotificationDataVo(value){var that={};var data=value||{};that.message=data["message"]||"";that.type=data["type"]||QuickNotificationMediator.TYPE_MESSAGE;return that;};function NotificationView(){var that=new ASJS.Sprite();var _mobileUtils=new MobileUtils().instance;var MAX_GAP=10;var TITLE_MAX_SIZE=50;var TITLE_FONT_MAX_SIZE=20;var CONTENT_FONT_MAX_SIZE=14;var BUTTON_MAX_SIZE=42;var BUTTON_FONT_MAX_SIZE=14;var _notificationItem={};var _window=new ASJS.Sprite();var _title=new ASJS.Sprite();var _content=new ASJS.Sprite();var _okButton=new ASJS.Button();var _cancelButton=new ASJS.Button();that.hideWindow=function(){_title.html="";_content.html="";if(that.contains(_okButton))that.removeChild(_okButton);_okButton.label="";if(that.contains(_cancelButton))that.removeChild(_cancelButton);_cancelButton.label="";};that.showWindow=function(notificationItem){_notificationItem=notificationItem;_title.html=_notificationItem.title;_content.html=_notificationItem.content;if(_notificationItem['showOk']){_okButton.label=_notificationItem['okLabel'];if(!that.contains(_okButton))that.addChild(_okButton);}else if(that.contains(_okButton))that.removeChild(_okButton);if(_notificationItem['showCancel']){_cancelButton.label=_notificationItem['cancelLabel'];if(!that.contains(_cancelButton))that.addChild(_cancelButton);}else if(that.contains(_cancelButton))that.removeChild(_cancelButton);};that.drawNow=function(){_window.setSize(Math.max(150,Math.min(that.width,_notificationItem.width)),Math.max(150,Math.min(that.height,_notificationItem.height)));_window.move((that.width-_window.width)*0.5,Math.max(0,(that.height-_window.height)*0.5));var gap=_mobileUtils.convertRatio(MAX_GAP,true);var calcGap=Math.min(gap,MAX_GAP);var titleFontSize=_mobileUtils.convertRatio(TITLE_FONT_MAX_SIZE,true);var titleSize=_mobileUtils.convertRatio(TITLE_MAX_SIZE,true);var titleCalcSize=Math.min(titleSize,TITLE_MAX_SIZE);var contentFontSize=_mobileUtils.convertRatio(CONTENT_FONT_MAX_SIZE,true);var buttonFontSize=_mobileUtils.convertRatio(BUTTON_FONT_MAX_SIZE,true);var buttonSize=_mobileUtils.convertRatio(BUTTON_MAX_SIZE,true);var buttonCalcFontSize=Math.min(buttonFontSize,BUTTON_FONT_MAX_SIZE);var buttonCalcSize=Math.min(buttonSize,BUTTON_MAX_SIZE);_title.setCSS("padding-left",calcGap+"px");_title.setCSS("padding-right",calcGap+"px");_title.setCSS("font-size",Math.min(titleFontSize,TITLE_FONT_MAX_SIZE)+"px");_title.setCSS("line-height",titleCalcSize+"px");_title.move(_window.x,_window.y);_title.setSize(_window.width-calcGap*2,titleCalcSize);_content.setCSS("padding-left",calcGap+"px");_content.setCSS("padding-right",calcGap+"px");_content.setCSS("font-size",Math.min(contentFontSize,CONTENT_FONT_MAX_SIZE)+"px");_content.move(_title.x,_title.y+_title.height+calcGap);_content.setSize(_title.width,_window.height-_title.height-calcGap-(that.contains(_okButton)||that.contains(_cancelButton)?(buttonCalcSize+calcGap*2):0));if(_content.drawNow)_content.drawNow();_okButton.setSize(_window.width*0.5-calcGap*2,buttonCalcSize);if(that.contains(_okButton)){_okButton.setCSS("font-size",buttonCalcFontSize+"px");_okButton.setCSS("line-height",buttonCalcSize+"px");_okButton.move(_window.x+(that.contains(_cancelButton)?_window.width*0.5-calcGap-_okButton.width:((_window.width-_okButton.width)*0.5)),_window.y+_window.height-_okButton.height-calcGap);};_cancelButton.setSize(_okButton.width,_okButton.height);if(that.contains(_cancelButton)){_cancelButton.setCSS("font-size",buttonCalcFontSize+"px");_cancelButton.setCSS("line-height",buttonCalcSize+"px");_cancelButton.move(_window.x+(that.contains(_okButton)?_window.width*0.5+calcGap:((_window.width-_cancelButton.width)*0.5)),_window.y+_window.height-_cancelButton.height-calcGap);}};function drawButtonStyle(target){target.addClass("notification_button");target.height=42;};(function(){that.setCSS("background-color","rgba( 0, 0, 0, 0.4 )");that.setSize("100%","100%");that.setCSS("position","fixed");_window.addClass("notification_window");that.addChild(_window);that.addChild(_title);_title.setCSS("line-height",_title.height+"px");_title.addClass("notification_title");_content.addClass("notification_content");that.addChild(_content);_okButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){if(_notificationItem['okCallback']!=undefined)_notificationItem['okCallback']();that.dispatchEvent(NotificationMediator.HIDE);});drawButtonStyle(_okButton);_cancelButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){if(_notificationItem['cancelCallback']!=undefined)_notificationItem['cancelCallback']();that.dispatchEvent(NotificationMediator.HIDE);});drawButtonStyle(_cancelButton);})();return that;};function NotificationDataVo(){var that={};that.title="";that.content="";that.showOk=true;that.showCancel=false;that.okCallback=null;that.cancelCallback=null;that.okLabel=null;that.cancelLabel=null;that.width=500;that.height=200;return that;};function NotificationMediator(view){var that=new ASJS.AbstractMediator(view);var _notificationPool=[];var _showed=false;var _defaultOkLabel="";var _defaultCancelLabel="";var _notificationView=new NotificationView();that.handlers=[ASJS.Stage.RESIZE,NotificationMediator.SHOW];that.reciveNotification=function(notificationType,data){switch(notificationType){case ASJS.Stage.RESIZE:onResize();break;case NotificationMediator.SHOW:show(data);break;}};that.setDefault=function(okLabel,cancelLabel){_defaultOkLabel=okLabel;_defaultCancelLabel=cancelLabel;};function onResize(){if(that.view.contains(_notificationView))_notificationView.drawNow();};function show(data){if(data==undefined)data=new NotificationDataVo();if(!data.okLabel)data.okLabel=_defaultOkLabel;if(!data.cancelLabel)data.cancelLabel=_defaultCancelLabel;_notificationPool.push(data);if(!_showed)showWindow();};function hide(){if(_notificationPool.length>0)showWindow();else hideWindow();};function hideWindow(){_notificationView.hideWindow();that.view.removeChild(_notificationView);_showed=false;$(".flash-content").css("visibility","visible");};function showWindow(){$(".flash-content").css("visibility","hidden");var notificationItem=_notificationPool[0];_notificationPool.shift();_showed=true;_notificationView.showWindow(notificationItem);_notificationView.alpha=0;if(!that.view.contains(_notificationView))that.view.addChild(_notificationView);onResize();$(_notificationView).stop().animate({alpha:1},{duration:500});};(function(){_notificationView.addEventListener(NotificationMediator.HIDE,function(event){hide();});that.registerNotificationHandlers();})();return that;};NotificationMediator.SHOW="NotificationMediator-show";NotificationMediator.HIDE="NotificationMediator-hide";function StatisticsDataVo(){var that={};var nowDate=new Date();var monthAgoDate=(new Date()).valueOf()-2592000000;var monthAgo=(new Date(monthAgoDate)).toYMD().split(". ").join("-").substr(0,10);var now=nowDate.toYMD().split(". ").join("-").substr(0,10);that.from=monthAgo;that.to=now;return that;};function StatisticsMediator(view){var that=new ASJS.AbstractMediator(view);var _language=new Language().instance;var _services=new Services().instance;var _statisticsView=new StatisticsView();that.handlers=[ASJS.Stage.RESIZE,StatisticsMediator.SHOW,StatisticsMediator.HIDE];that.reciveNotification=function(notificationType,data){switch(notificationType){case ASJS.Stage.RESIZE:onResize();break;case StatisticsMediator.SHOW:onShow();break;case StatisticsMediator.HIDE:onHide();break;}};function onResize(){_statisticsView.setSize(stage.stageWidth,stage.stageHeight);_statisticsView.drawNow();};function onShow(){if(that.view.contains(_statisticsView))return;stage.window.scrollTop(0);that.view.addChild(_statisticsView);loadEntries();};function onHide(){if(!that.view.contains(_statisticsView))return;that.view.removeEventListeners();that.view.removeChild(_statisticsView);};function loadEntries(){that.sendNotification(PreloaderMediator.SHOW);var statisticsDataVo=new StatisticsDataVo();_services.getSettings(function(response){_statisticsView.dailyCalories=response["daily_calories"];_services.getStatistics(statisticsDataVo,function(response){that.sendNotification(PreloaderMediator.HIDE);_statisticsView.statistics=response;onResize();},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);onResize();});},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);onResize();});};(function(){that.registerNotificationHandlers();})();return that;};StatisticsMediator.SHOW="StatisticsMediator-show";StatisticsMediator.HIDE="StatisticsMediator-hide";function FoodListCell(){var that=new ASJS.Cell();var _super={};var _language=new Language().instance;var _mobileUtils=new MobileUtils().instance;var CELL_MAX_HEIGHT=90;var DELETE_BUTTON_MAX_SIZE=46;var ICON_MAX_SIZE=86;var TITLE_MAX_HEIGHT=30;var TITLE_FONT_MAX_SIZE=26;var TITLE_MAX_X=108;var TITLE_MAX_Y=21;var CALORIES_MAX_HEIGHT=24;var CALORIES_FONT_MAX_SIZE=20;var CALORIES_MAX_X=108;var CALORIES_MAX_Y=47;that.ICON_CLASSES=["food_list_cell_icon_food","food_list_cell_icon_drink","food_list_cell_icon_sport"];that._box;that._title;that._calories;that._icon;that._deleteButton;defineProperty(that,"title",{get:function(){return that._title.text;},set:function(value){that._title.text=value;}});defineProperty(that,"calories",{get:function(){return that._calories.text;},set:function(value){that._calories.text=value;}});that.showData=function(){that.title=that.data.name;that._icon.addClass(that.ICON_CLASSES[that.data.type]);that.calories=(that.data.type==2?"-":"")+that.data.calories+_language.getText("calorie_unit");};that.drawNow=function(){var cellHeight=_mobileUtils.convertRatio(CELL_MAX_HEIGHT,true);that.setSize("100%",Math.min(cellHeight,CELL_MAX_HEIGHT));var marginSize=_mobileUtils.convertRatio(AbstractInAppView.GAP,true);var marginCalcSize=Math.min(marginSize,AbstractInAppView.GAP);that.setCSS("margin-top",marginCalcSize);that.setCSS("margin-bottom",marginCalcSize);var iconSize=_mobileUtils.convertRatio(ICON_MAX_SIZE,true);var iconCalcSize=Math.min(iconSize,ICON_MAX_SIZE);that._icon.setSize(iconCalcSize,iconCalcSize);that._icon.y=(that.height-that._icon.height)*0.5;that._icon.x=that._icon.y;that._box.setSize(that.width,that.height);var deleteButtonMaxSize=_mobileUtils.convertRatio(DELETE_BUTTON_MAX_SIZE,true);var deleteButtonCalcSize=Math.min(deleteButtonMaxSize,DELETE_BUTTON_MAX_SIZE);that._deleteButton.setSize(deleteButtonCalcSize,deleteButtonCalcSize);that._deleteButton.y=(that.height-that._deleteButton.height)*0.5;that._deleteButton.x=that.width-that._deleteButton.y-that._deleteButton.width;that._deleteButton.setCSS("border-radius",that._deleteButton.width+"px");var titleHeight=_mobileUtils.convertRatio(TITLE_MAX_HEIGHT,true);var titleFontSize=_mobileUtils.convertRatio(TITLE_FONT_MAX_SIZE,true);var titleX=_mobileUtils.convertRatio(TITLE_MAX_X,true);var titleY=_mobileUtils.convertRatio(TITLE_MAX_Y,true);that._title.move(Math.min(titleX,TITLE_MAX_X),Math.min(titleY,TITLE_MAX_Y));that._title.width=that._deleteButton.x-that._title.x-AbstractInAppView.GAP;that._title.height=Math.min(titleHeight,TITLE_MAX_HEIGHT);that._title.setCSS("line-height",that._title.height+"px");that._title.setCSS("font-size",Math.min(titleFontSize,TITLE_FONT_MAX_SIZE)+"px");var caloriesHeight=_mobileUtils.convertRatio(CALORIES_MAX_HEIGHT,true);var caloriesFontSize=_mobileUtils.convertRatio(CALORIES_FONT_MAX_SIZE,true);var caloriesX=_mobileUtils.convertRatio(CALORIES_MAX_X,true);var caloriesY=_mobileUtils.convertRatio(CALORIES_MAX_Y,true);that._calories.move(Math.min(caloriesX,CALORIES_MAX_X),Math.min(caloriesY,CALORIES_MAX_Y));that._calories.width=that._deleteButton.x-that._calories.x-AbstractInAppView.GAP;that._calories.height=Math.min(caloriesHeight,CALORIES_MAX_HEIGHT);that._calories.setCSS("line-height",that._calories.height+"px");that._calories.setCSS("font-size",Math.min(caloriesFontSize,CALORIES_FONT_MAX_SIZE)+"px");};(function(){that.addClass("food_list_cell");that.setCSS("position","relative");that.setCSS("float","left");that._box=new ASJS.Sprite();that._box.addClass("food_list_cell_box");that.addChild(that._box);that._icon=new ASJS.DisplayObject();that._icon.addClass("food_list_cell_icon");that._box.addChild(that._icon);that._title=new ASJS.Label();that._title.addClass("food_list_cell_title");that._box.addChild(that._title);that._calories=new ASJS.Label();that._calories.addClass("food_list_cell_calories");that._box.addChild(that._calories);that._deleteButton=new ASJS.Button();that._deleteButton.addClass("food_list_cell_delete_button");that._deleteButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){event.stopPropagation();that.dispatchEvent(FoodListCell.DELETE,[that]);});that._box.addChild(that._deleteButton);that.mouseChildren=true;})();return that;};FoodListCell.DELETE="FoodListCell-delete";function FoodEntryDataVo(value){var that={};var data=value||{};that.name=data["name"]||"";that.type=data["type"]||0;that.calories=data["calories"]||1;return that;};function FoodDataVo(value){var that=new FoodEntryDataVo(value);var data=value||{};that.id=data["id"]||null;return that;};function FoodListView(){var that=new AbstractInAppView();var _super={};var _language=new Language().instance;var _foodListLabel;var _addButton;var _foodList;var _foodListData=[];defineProperty(that,"foodList",{get:function(){return _foodListData;},set:function(value){_foodListData=value;var i;var l=_foodListData.length;var foodList=[];var foodData;for(i=l-1;i>-1;i--){foodData=new FoodDataVo(_foodListData[i]);foodList.push(foodData);};_foodList.setList(foodList);}});extendFunction(_super,that,"drawNow");that.drawNow=function(){_super.drawNow();_foodListLabel.move(0,AbstractInAppView.GAP);_foodListLabel.setSize(that._container.width,that._container.height);_foodListLabel.drawNow();_addButton.setSize(that._container.width,that._container.height);_addButton.drawNow();_foodList.move(_foodListLabel.x,_foodListLabel.y+_foodListLabel.height+AbstractInAppView.GAP);_foodList.width=that._container.width;_foodList.drawNow();_foodList.height=_foodList.getChildAt(0).calcHeight+_addButton.calcHeight*2;};function removedFromStage(){_foodList.clearList();};(function(){that.addEventListener(ASJS.Stage.REMOVED_FROM_STAGE,removedFromStage);_foodListLabel=new Label();_foodListLabel.text=_language.getText("food_list_label");_foodListLabel.icon="images/icons/food_list.png";that._container.addChild(_foodListLabel);_foodList=new ASJS.CustomList();_foodList.addClass("food_list");_foodList.cell=FoodListCell;_foodList.addEventListener(FoodListCell.DELETE,function(event,cell){if(!cell)return;that.dispatchEvent(FoodListMediator.DELETE_ITEM,[cell.data]);});that._container.addChild(_foodList);_addButton=new AddButton();_addButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(FoodListMediator.ON_ADD_CLICK);});that._container.addChild(_addButton);})();return that;};function AbstractModalView(){var that=new ASJS.Sprite();var _background;(function(){_background=new ASJS.DisplayObject();_background.addClass("modal_background");_background.setSize("100%","100%");_background.move(0,0);_background.setCSS("position","fixed");that.addChild(_background);})();return that;};function Button(){var that=new ASJS.Button();var _mobileUtils=new MobileUtils().instance;var BUTTON_MAX_WIDTH=322;var BUTTON_MAX_HEIGHT=70;var BUTTON_MAX_FONT_SIZE=24;var BUTTON_MAX_BORDER_SIZE=2;that.drawNow=function(){var buttonWidth=_mobileUtils.convertRatio(BUTTON_MAX_WIDTH,true);var buttonHeight=_mobileUtils.convertRatio(BUTTON_MAX_HEIGHT,true);var buttonFontSize=_mobileUtils.convertRatio(BUTTON_MAX_FONT_SIZE,true);var buttonBorderSize=_mobileUtils.convertRatio(BUTTON_MAX_BORDER_SIZE,true);that.setSize(Math.min(buttonWidth,BUTTON_MAX_WIDTH),Math.min(buttonHeight,BUTTON_MAX_HEIGHT));that.setCSS("font-size",Math.min(buttonFontSize,BUTTON_MAX_FONT_SIZE)+"px");that.setCSS("border-width",Math.min(buttonBorderSize,BUTTON_MAX_BORDER_SIZE)+"px");};(function(){that.addClass("button");})();return that;};function AddFoodEntryView(){var that=new AbstractModalView();var _language=new Language().instance;var _mobileUtils=new MobileUtils().instance;var CALORIE_TYPE_BUTTON_SIZE=100;var CALORIE_TYPE_BORDER_SIZE=2;var _type=0;var _addFoodEntryLabel;var _foodButton;var _drinkButton;var _sportButton;var _calorieTypeIcon;var _nameInput;var _calorieInput;var _saveButton;var _cancelButton;defineProperty(that,"foodType",{get:function(){return _type;}});defineProperty(that,"foodName",{get:function(){return _nameInput.val;}});defineProperty(that,"foodCalories",{get:function(){return Number(_calorieInput.val);}});that.reset=function(){_type=0;_calorieInput.val="0";switchCalorieType(_foodButton);};that.drawNow=function(){_addFoodEntryLabel.move(0,AbstractInAppView.GAP);_addFoodEntryLabel.setSize(that.width,that.height);_addFoodEntryLabel.drawNow();var calorieTypeButtonSize=_mobileUtils.convertRatio(CALORIE_TYPE_BUTTON_SIZE,true);var calorieTypeButtonCalcSize=Math.min(calorieTypeButtonSize,CALORIE_TYPE_BUTTON_SIZE);var calorieTypeBorderSize=_mobileUtils.convertRatio(CALORIE_TYPE_BORDER_SIZE,true);var calorieTypeBorderCalcSize=Math.min(calorieTypeBorderSize,CALORIE_TYPE_BORDER_SIZE);_foodButton.setSize(calorieTypeButtonCalcSize,calorieTypeButtonCalcSize);_foodButton.setCSS("border-width",calorieTypeBorderCalcSize+"px");_drinkButton.setSize(calorieTypeButtonCalcSize,calorieTypeButtonCalcSize);_drinkButton.setCSS("border-width",calorieTypeBorderCalcSize+"px");_sportButton.setSize(calorieTypeButtonCalcSize,calorieTypeButtonCalcSize);_sportButton.setCSS("border-width",calorieTypeBorderCalcSize+"px");_foodButton.move((that.width-((_foodButton.width+AbstractInAppView.GAP*3)*3-AbstractInAppView.GAP*3))*0.5,_addFoodEntryLabel.y+_addFoodEntryLabel.height+AbstractInAppView.GAP*2);_drinkButton.move(_foodButton.x+_foodButton.width+AbstractInAppView.GAP*3,_foodButton.y);_sportButton.move(_drinkButton.x+_drinkButton.width+AbstractInAppView.GAP*3,_foodButton.y);_calorieInput.drawNow();_nameInput.drawNow();_nameInput.move((that.width-_calorieInput.calcWidth)*0.5,_foodButton.y+_foodButton.height+AbstractInAppView.GAP*3);_calorieInput.move((that.width-_calorieInput.calcWidth)*0.5,_nameInput.y+_nameInput.height+AbstractInAppView.GAP*2);_saveButton.drawNow();_cancelButton.drawNow();_saveButton.move((that.width-_saveButton.calcWidth)*0.5,_calorieInput.y+_calorieInput.calcHeight+AbstractInAppView.GAP*3);_cancelButton.move(_saveButton.x,_saveButton.y+_saveButton.calcHeight+AbstractInAppView.GAP*2);};function switchCalorieType(target){var minAlpha=0.4;_foodButton.alpha=target==_foodButton?1:minAlpha;_drinkButton.alpha=target==_drinkButton?1:minAlpha;_sportButton.alpha=target==_sportButton?1:minAlpha;_nameInput.val="";switch(target){case _foodButton:_nameInput.placeholder=_language.getText("food_name_placeholder");_type=0;break;case _drinkButton:_nameInput.placeholder=_language.getText("drink_name_placeholder");_type=1;break;case _sportButton:_nameInput.placeholder=_language.getText("sport_name_placeholder");_type=2;break;}};(function(){_addFoodEntryLabel=new Label();_addFoodEntryLabel.text=_language.getText("add_food_entry_label");_addFoodEntryLabel.icon="images/icons/add.png";that.addChild(_addFoodEntryLabel);_foodButton=new ASJS.Button();_foodButton.addClass("food_button_selector");_foodButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){switchCalorieType(_foodButton);});that.addChild(_foodButton);_drinkButton=new ASJS.Button();_drinkButton.addClass("drink_button_selector");_drinkButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){switchCalorieType(_drinkButton);});that.addChild(_drinkButton);_sportButton=new ASJS.Button();_sportButton.addClass("sport_button_selector");_sportButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){switchCalorieType(_sportButton);});that.addChild(_sportButton);_nameInput=new TextInput();_nameInput.maxChar=30;that.addChild(_nameInput);_calorieInput=new TextInput();_calorieInput.restrict="[0-9]";_calorieInput.maxChar=5;that.addChild(_calorieInput);_saveButton=new Button();_saveButton.addClass("button");_saveButton.label=_language.getText("save");_saveButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(AddFoodEntryMediator.ON_SAVE_CLICK);});that.addChild(_saveButton);_cancelButton=new Button();_cancelButton.addClass("button");_cancelButton.label=_language.getText("cancel");_cancelButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(AddFoodEntryMediator.ON_CANCEL_CLICK);});that.addChild(_cancelButton);that.reset();})();return that;};function PreloaderView(){var that=new ASJS.Sprite();(function(){that.setSize("100%","100%");that.setCSS("position","fixed");that.addClass("preloader");})();return that;};function PreloaderMediator(view){var that=new ASJS.AbstractMediator(view);var _counter=0;var _preloaderView=new PreloaderView();that.handlers=[PreloaderMediator.SHOW,PreloaderMediator.HIDE];that.reciveNotification=function(notificationType,data){switch(notificationType){case PreloaderMediator.SHOW:onShow();break;case PreloaderMediator.HIDE:onHide();break;}};function onShow(){_counter++;if(_counter==1&&!that.view.contains(_preloaderView)){$(".flash-content").css("visibility","hidden");_preloaderView.alpha=0;that.view.addChild(_preloaderView);$(_preloaderView).stop().animate({alpha:1},{duration:500});}};function onHide(){_counter--;if(_counter<0)_counter=0;if(_counter==0&&that.view.contains(_preloaderView)){$(_preloaderView).stop().animate({alpha:0},{duration:500,complete:function(){that.view.removeChild(_preloaderView);$(".flash-content").css("visibility","visible");}});}};(function(){that.registerNotificationHandlers();})();return that;};PreloaderMediator.SHOW="PreloaderMediator-show";PreloaderMediator.HIDE="PreloaderMediator-hide";function AddFoodEntryMediator(view){var that=new ASJS.AbstractMediator(view);var _language=new Language().instance;var _services=new Services().instance;var _addFoodEntryView=new AddFoodEntryView();that.handlers=[ASJS.Stage.RESIZE,AddFoodEntryMediator.SHOW,AddFoodEntryMediator.HIDE];that.reciveNotification=function(notificationType,data){switch(notificationType){case ASJS.Stage.RESIZE:onResize();break;case AddFoodEntryMediator.SHOW:onShow();break;case AddFoodEntryMediator.HIDE:onHide();break;}};function onResize(){_addFoodEntryView.setSize(stage.stageWidth,stage.stageHeight);_addFoodEntryView.drawNow();};function onShow(){if(that.view.contains(_addFoodEntryView))return;stage.window.scrollTop(0);that.view.addEventListener(AddFoodEntryMediator.ON_SAVE_CLICK,function(event){var foodName=_addFoodEntryView.foodName;var foodCalories=_addFoodEntryView.foodCalories;var foodType=_addFoodEntryView.foodType;if(foodName==""||foodCalories<=0){that.sendNotification(QuickNotificationMediator.SHOW,new QuickNotificationDataVo(_language.getText("empty_name_or_calories"),QuickNotificationMediator.TYPE_MESSAGE));return;};that.sendNotification(PreloaderMediator.SHOW);var foodEntryDataVo=new FoodEntryDataVo();foodEntryDataVo.name=foodName;foodEntryDataVo.type=foodType;foodEntryDataVo.calories=foodCalories;_services.addFood(foodEntryDataVo,function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("success");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_SUCCESS;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);that.sendNotification(AddFoodEntryMediator.ENTRY_ADDED);_addFoodEntryView.reset();onHide();},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);});});that.view.addEventListener(AddFoodEntryMediator.ON_CANCEL_CLICK,function(event){onHide();});that.view.addChild(_addFoodEntryView);onResize();};function onHide(){if(!that.view.contains(_addFoodEntryView))return;that.view.removeEventListeners();that.view.removeChild(_addFoodEntryView);};(function(){that.registerNotificationHandlers();})();return that;};AddFoodEntryMediator.SHOW="AddFoodEntryMediator-show";AddFoodEntryMediator.HIDE="AddFoodEntryMediator-hide";AddFoodEntryMediator.ON_SAVE_CLICK="AddFoodEntryMediator-onSaveClick";AddFoodEntryMediator.ON_CANCEL_CLICK="AddFoodEntryMediator-onCancelClick";AddFoodEntryMediator.ENTRY_ADDED="AddFoodEntryMediator-entryAdded";function FoodListMediator(view){var that=new ASJS.AbstractMediator(view);var _language=new Language().instance;var _services=new Services().instance;var _tools=new Tools().instance;var _foodListView=new FoodListView();that.handlers=[ASJS.Stage.RESIZE,FoodListMediator.SHOW,FoodListMediator.HIDE,AddFoodEntryMediator.ENTRY_ADDED];that.reciveNotification=function(notificationType,data){switch(notificationType){case ASJS.Stage.RESIZE:onResize();break;case FoodListMediator.SHOW:onShow();break;case FoodListMediator.HIDE:onHide();break;case AddFoodEntryMediator.ENTRY_ADDED:loadEntries();break;}};function onResize(){_foodListView.setSize(stage.stageWidth,stage.stageHeight);_foodListView.drawNow();};function onShow(){if(that.view.contains(_foodListView))return;stage.window.scrollTop(0);that.view.addEventListener(FoodListMediator.ON_ADD_CLICK,function(event){that.sendNotification(AddFoodEntryMediator.SHOW);});that.view.addEventListener(FoodListMediator.DELETE_ITEM,function(event,data){var notificationDataVo=new NotificationDataVo();notificationDataVo.title=_language.getText("notification_delete_title");notificationDataVo.content=_tools.replaceText(_language.getText("notification_delete_content"),data);notificationDataVo.showOk=true;notificationDataVo.showCancel=true;notificationDataVo.okCallback=function(){onDeleteItem(data);};that.sendNotification(NotificationMediator.SHOW,notificationDataVo);});that.view.addChild(_foodListView);loadEntries();};function onDeleteItem(data){that.sendNotification(PreloaderMediator.SHOW);_services.deleteFoodById(data.id,function(response){that.sendNotification(PreloaderMediator.HIDE);if(response.success){var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("success");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_SUCCESS;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);loadEntries();}else{var notificationDataVo=new NotificationDataVo();notificationDataVo.title=_language.getText("notification_alert_title");notificationDataVo.content=_tools.replaceText(_language.getText("notification_food_exists_in_calories_list"),data);notificationDataVo.showOk=true;that.sendNotification(NotificationMediator.SHOW,notificationDataVo);}},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);});};function loadEntries(){if(!that.view.contains(_foodListView))return;that.sendNotification(PreloaderMediator.SHOW);_services.getFoodList(function(response){that.sendNotification(PreloaderMediator.HIDE);response.sort(function(a,b){if(a["name"]>b["name"])return-1;if(a["name"]<b["name"])return 1;return 0;});_foodListView.foodList=response;if(response.length==0){var notificationDataVo=new NotificationDataVo();notificationDataVo.title=_language.getText("notification_tip_title");notificationDataVo.content=_language.getText("notification_add_entry_content");notificationDataVo.showOk=true;that.sendNotification(NotificationMediator.SHOW,notificationDataVo);};onResize();},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);onResize();});};function onHide(){if(!that.view.contains(_foodListView))return;that.view.removeEventListeners();that.view.removeChild(_foodListView);};(function(){that.registerNotificationHandlers();})();return that;};FoodListMediator.SHOW="FoodListMediator-show";FoodListMediator.HIDE="FoodListMediator-hide";FoodListMediator.ON_ADD_CLICK="FoodListMediator-onAddClick";FoodListMediator.DELETE_ITEM="FoodListMediator-deleteItem";function SettingsView(){var that=new AbstractInAppView();var _super={};var _language=new Language().instance;var _mobileUtils=new MobileUtils().instance;var _dailyCaloriesLabel;var _dailyCaloriesInput;var _saveButton;defineProperty(that,"dailyCalories",{get:function(){return Number(_dailyCaloriesInput.val);},set:function(value){_dailyCaloriesInput.val=Math.max(value,0);}});extendFunction(_super,that,"drawNow");that.drawNow=function(){_super.drawNow();var inputButtonGap=AbstractInAppView.GAP*3;_dailyCaloriesLabel.move(0,AbstractInAppView.GAP);_dailyCaloriesLabel.setSize(that._container.width,that._container.height);_dailyCaloriesLabel.drawNow();_dailyCaloriesInput.drawNow();_saveButton.drawNow();_dailyCaloriesInput.move((that._container.width-_dailyCaloriesInput.calcWidth)*0.5,_dailyCaloriesLabel.y+_dailyCaloriesLabel.height+(((that._container.height-(AbstractInAppView.GAP+_dailyCaloriesLabel.height))-(_dailyCaloriesInput.calcHeight+_saveButton.calcHeight+inputButtonGap))*0.5));_saveButton.move((that._container.width-_saveButton.calcWidth)*0.5,_dailyCaloriesInput.y+_dailyCaloriesInput.calcHeight+inputButtonGap);};(function(){_dailyCaloriesLabel=new Label();_dailyCaloriesLabel.text=_language.getText("daily_calories_label");_dailyCaloriesLabel.icon="images/icons/settings.png";that._container.addChild(_dailyCaloriesLabel);_dailyCaloriesInput=new TextInput();_dailyCaloriesInput.restrict="[0-9]";_dailyCaloriesInput.maxChar=5;that._container.addChild(_dailyCaloriesInput);_saveButton=new Button();_saveButton.addClass("button");_saveButton.label=_language.getText("save");_saveButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(SettingsMediator.ON_SAVE_CLICK);});that._container.addChild(_saveButton);})();return that;};function SettingsDataVo(value){var that={};var data=value||{};that.daily_calories=data["daily_calories"]||null;return that;};function SettingsMediator(view){var that=new ASJS.AbstractMediator(view);var _language=new Language().instance;var _services=new Services().instance;var _settingsView=new SettingsView();that.handlers=[ASJS.Stage.RESIZE,SettingsMediator.SHOW,SettingsMediator.HIDE];that.reciveNotification=function(notificationType,data){switch(notificationType){case ASJS.Stage.RESIZE:onResize();break;case SettingsMediator.SHOW:onShow();break;case SettingsMediator.HIDE:onHide();break;}};function onResize(){_settingsView.setSize(stage.stageWidth,stage.stageHeight);_settingsView.drawNow();};function onShow(){if(that.view.contains(_settingsView))return;stage.window.scrollTop(0);that.view.addEventListener(SettingsMediator.ON_SAVE_CLICK,function(events){that.sendNotification(PreloaderMediator.SHOW);var settingsDataVo=new SettingsDataVo();settingsDataVo.daily_calories=_settingsView.dailyCalories;_services.setSettings(settingsDataVo,function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("success");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_SUCCESS;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);});});that.view.addChild(_settingsView);that.sendNotification(PreloaderMediator.SHOW);_services.getSettings(function(response){_settingsView.dailyCalories=response["daily_calories"];that.sendNotification(PreloaderMediator.HIDE);},function(response){var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);});onResize();};function onHide(){if(!that.view.contains(_settingsView))return;that.view.removeEventListeners();that.view.removeChild(_settingsView);};(function(){that.registerNotificationHandlers();})();return that;};SettingsMediator.SHOW="SettingsMediator-show";SettingsMediator.HIDE="SettingsMediator-hide";SettingsMediator.ON_SAVE_CLICK="SettingsMediator-ON_SAVE_CLICK";function AddFoodListCell(){var that=new FoodListCell();(function(){that._deleteButton.removeEventListeners();that.removeChild(that._deleteButton);})();return that;};function AddCalorieEntryView(){var that=new AbstractModalView();var _language=new Language().instance;var _mobileUtils=new MobileUtils().instance;var _addCalorieEntryLabel;var _foodList;var _foodListData=[];var _addButton;var _cancelButton;defineProperty(that,"foodList",{get:function(){return _foodListData;},set:function(value){_foodListData=value;var i;var l=_foodListData.length;var foodList=[];var foodData;for(i=l-1;i>-1;i--){foodData=new FoodDataVo(_foodListData[i]);foodList.push(foodData);};_foodList.setList(foodList);}});that.drawNow=function(){_addCalorieEntryLabel.move(0,AbstractInAppView.GAP);_addCalorieEntryLabel.setSize(that.width,that.height);_addCalorieEntryLabel.drawNow();_addButton.drawNow();_cancelButton.drawNow();_foodList.move(_addCalorieEntryLabel.x,_addCalorieEntryLabel.y+_addCalorieEntryLabel.height+AbstractInAppView.GAP);_foodList.width=that.width;_foodList.drawNow();_foodList.height=_foodList.getChildAt(0).calcHeight+(_addButton.calcHeight+AbstractInAppView.GAP*2)*3;_cancelButton.move((that.width-_addButton.calcWidth)*0.5,that.height-_cancelButton.calcHeight-AbstractInAppView.GAP*2);_addButton.move(_cancelButton.x,_cancelButton.y-_addButton.calcHeight-AbstractInAppView.GAP*2);};function removedFromStage(){_foodList.clearList();};(function(){that.addEventListener(ASJS.Stage.REMOVED_FROM_STAGE,removedFromStage);_addCalorieEntryLabel=new Label();_addCalorieEntryLabel.text=_language.getText("add_calorie_entry_label");_addCalorieEntryLabel.icon="images/icons/add.png";that.addChild(_addCalorieEntryLabel);_foodList=new ASJS.CustomList();_foodList.addClass("food_list");_foodList.cell=AddFoodListCell;_foodList.addEventListener(ASJS.CustomList.CHANGE,function(event){var selected=_foodList.selected;var cell=selected[0];if(!cell)return;that.dispatchEvent(AddCalorieEntryMediator.ON_ADD_CLICK,[cell.data]);});that.addChild(_foodList);_addButton=new Button();_addButton.setCSS("position","fixed");_addButton.addClass("button");_addButton.label=_language.getText("add_new_food");_addButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(AddCalorieEntryMediator.ON_ADD_NEW_FOOD_ENTRY_CLICK);});that.addChild(_addButton);_cancelButton=new Button();_cancelButton.setCSS("position","fixed");_cancelButton.addClass("button");_cancelButton.label=_language.getText("cancel");_cancelButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(AddCalorieEntryMediator.ON_CANCEL_CLICK);});that.addChild(_cancelButton);})();return that;};function CalorieEntryDataVo(value){var that={};var data=value||{};that.foodId=data["food_id"]||null;return that;};function AddCalorieEntryMediator(view){var that=new ASJS.AbstractMediator(view);var _language=new Language().instance;var _services=new Services().instance;var _addCalorieEntryView=new AddCalorieEntryView();that.handlers=[ASJS.Stage.RESIZE,AddCalorieEntryMediator.SHOW,AddCalorieEntryMediator.HIDE,AddFoodEntryMediator.ENTRY_ADDED];that.reciveNotification=function(notificationType,data){switch(notificationType){case ASJS.Stage.RESIZE:onResize();break;case AddCalorieEntryMediator.SHOW:onShow();break;case AddCalorieEntryMediator.HIDE:onHide();break;case AddFoodEntryMediator.ENTRY_ADDED:loadEntries();break;}};function onResize(){_addCalorieEntryView.setSize(stage.stageWidth,stage.stageHeight);_addCalorieEntryView.drawNow();};function onShow(){if(that.view.contains(_addCalorieEntryView))return;stage.window.scrollTop(0);that.view.addEventListener(AddCalorieEntryMediator.ON_ADD_CLICK,function(event,data){that.sendNotification(PreloaderMediator.SHOW);var calorieEntryDataVo=new CalorieEntryDataVo();calorieEntryDataVo.foodId=data.id;_services.addCalorie(calorieEntryDataVo,function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("success");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_SUCCESS;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);that.sendNotification(AddCalorieEntryMediator.ENTRY_ADDED);onHide();},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);});});that.view.addEventListener(AddCalorieEntryMediator.ON_ADD_NEW_FOOD_ENTRY_CLICK,function(event){that.sendNotification(AddFoodEntryMediator.SHOW);});that.view.addEventListener(AddCalorieEntryMediator.ON_CANCEL_CLICK,function(event){onHide();});that.view.addChild(_addCalorieEntryView);loadEntries();};function onHide(){if(!that.view.contains(_addCalorieEntryView))return;that.view.removeEventListeners();that.view.removeChild(_addCalorieEntryView);};function loadEntries(){if(!that.view.contains(_addCalorieEntryView))return;that.sendNotification(PreloaderMediator.SHOW);_services.getFoodList(function(response){that.sendNotification(PreloaderMediator.HIDE);response.sort(function(a,b){if(a["name"]>b["name"])return-1;if(a["name"]<b["name"])return 1;return 0;});_addCalorieEntryView.foodList=response;if(response.length==0){var notificationDataVo=new NotificationDataVo();notificationDataVo.title=_language.getText("notification_tip_title");notificationDataVo.content=_language.getText("notification_add_entry_content");notificationDataVo.showOk=true;that.sendNotification(NotificationMediator.SHOW,notificationDataVo);};onResize();},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);onResize();});};(function(){that.registerNotificationHandlers();})();return that;};AddCalorieEntryMediator.SHOW="AddCalorieEntryMediator-show";AddCalorieEntryMediator.HIDE="AddCalorieEntryMediator-hide";AddCalorieEntryMediator.ON_ADD_CLICK="AddCalorieEntryMediator-onAddClick";AddCalorieEntryMediator.ON_ADD_NEW_FOOD_ENTRY_CLICK="AddCalorieEntryMediator-onAddNewFoodEntryClick";AddCalorieEntryMediator.ON_CANCEL_CLICK="AddCalorieEntryMediator-onCancelClick";AddCalorieEntryMediator.ENTRY_ADDED="AddCalorieEntryMediator-entryAdded";function AbstractShowCommand(){var that=new ASJS.AbstractCommand();that.execute=function(){that.sendNotification(PreloaderMediator.SHOW);that.sendNotification(CaloriesMediator.HIDE);that.sendNotification(StatisticsMediator.HIDE);that.sendNotification(FoodListMediator.HIDE);that.sendNotification(SettingsMediator.HIDE);that.sendNotification(AddCalorieEntryMediator.HIDE);that.sendNotification(PreloaderMediator.HIDE);};return that;};function ShowCaloriesCommand(){var that=new AbstractShowCommand();var _super={};extendFunction(_super,that,"execute");that.execute=function(){_super.execute();that.sendNotification(PreloaderMediator.SHOW);that.sendNotification(CaloriesMediator.SHOW);that.sendNotification(PreloaderMediator.HIDE);};return that;};function ShowStatisticsCommand(){var that=new AbstractShowCommand();var _super={};extendFunction(_super,that,"execute");that.execute=function(){_super.execute();that.sendNotification(PreloaderMediator.SHOW);that.sendNotification(StatisticsMediator.SHOW);that.sendNotification(PreloaderMediator.HIDE);};return that;};function ShowFoodListCommand(){var that=new AbstractShowCommand();var _super={};extendFunction(_super,that,"execute");that.execute=function(){_super.execute();that.sendNotification(PreloaderMediator.SHOW);that.sendNotification(FoodListMediator.SHOW);that.sendNotification(PreloaderMediator.HIDE);};return that;};function ShowSettingsCommand(){var that=new AbstractShowCommand();var _super={};extendFunction(_super,that,"execute");that.execute=function(){_super.execute();that.sendNotification(PreloaderMediator.SHOW);that.sendNotification(SettingsMediator.SHOW);that.sendNotification(PreloaderMediator.HIDE);};return that;};function MenuMediator(view){var that=new ASJS.AbstractMediator(view);var _language=new Language().instance;var _menuView=new MenuView();that.handlers=[ASJS.Stage.RESIZE,MenuMediator.SHOW];that.reciveNotification=function(notificationType,data){switch(notificationType){case ASJS.Stage.RESIZE:onResize();break;case MenuMediator.SHOW:onShow();break;}};function onResize(){_menuView.drawNow();};function onShow(){if(that.view.contains(_menuView))return;that.view.addEventListener(MenuMediator.ON_CALORIES_CLICK,function(event){(new ShowCaloriesCommand()).execute();});that.view.addEventListener(MenuMediator.ON_STATISTICS_CLICK,function(event){(new ShowStatisticsCommand()).execute();});that.view.addEventListener(MenuMediator.ON_FOOD_LIST_CLICK,function(event){(new ShowFoodListCommand()).execute();});that.view.addEventListener(MenuMediator.ON_SETTINGS_CLICK,function(event){(new ShowSettingsCommand()).execute();});that.view.addChild(_menuView);onResize();};(function(){that.registerNotificationHandlers();})();return that;};MenuMediator.SHOW="MenuMediator-show";MenuMediator.ON_CALORIES_CLICK="MenuMediator-onCaloriesClick";MenuMediator.ON_STATISTICS_CLICK="MenuMediator-onStatisticsClick";MenuMediator.ON_FOOD_LIST_CLICK="MenuMediator-onFoodListClick";MenuMediator.ON_SETTINGS_CLICK="MenuMediator-onSettingsClick";function MenuView(){var that=new ASJS.Sprite();var _language=new Language().instance;var _mobileUtils=new MobileUtils().instance;var MENU_MAX_BORDER_SIZE=2;var MENU_MAX_HEIGHT=MenuView.MENU_SIZE-MENU_MAX_BORDER_SIZE;var MENU_BUTTON_MAX_WIDTH=60;var MENU_BUTTON_MAX_HEIGHT=54;var MENU_BUTTONS_CONTAINER_MAX_WIDTH=800;var _menuBackground;var _menuButtonsContainer;var _caloriesButton;var _statisticsButton;var _foodListButton;var _settingsButton;that.drawNow=function(){var isPortrait=_mobileUtils.getOrientation()==MobileUtils.ORIENTATION_PORTRAIT;var menuBorderSize;var menuButtonWidth;var menuButtonHeight;var menuButtonIconWidth;var menuButtonIconHeight;var menuButtonCalcWidth;var menuButtonCalcHeight;if(isPortrait){var menuHeight=_mobileUtils.convertRatio(MENU_MAX_HEIGHT,true);menuBorderSize=_mobileUtils.convertRatio(MENU_MAX_BORDER_SIZE,true);_menuBackground.setSize(stage.stageWidth,Math.min(menuHeight,MENU_MAX_HEIGHT));_menuBackground.setCSS("border","none");_menuBackground.setCSS("border-bottom","2px solid #FFFFFF");_menuBackground.setCSS("border-width",Math.min(menuBorderSize,MENU_MAX_BORDER_SIZE)+"px");var menuButtonsContainerWidth=_mobileUtils.convertRatio(MENU_BUTTONS_CONTAINER_MAX_WIDTH,true);_menuButtonsContainer.setSize(Math.min(stage.stageWidth,Math.min(menuButtonsContainerWidth,MENU_BUTTONS_CONTAINER_MAX_WIDTH)),_menuBackground.height);_menuButtonsContainer.move((stage.stageWidth-_menuButtonsContainer.width)*0.5,0);menuButtonWidth=_mobileUtils.convertRatio(MENU_BUTTON_MAX_WIDTH,true);menuButtonHeight=_mobileUtils.convertRatio(MENU_BUTTON_MAX_HEIGHT,true);menuButtonIconWidth=Math.min(menuButtonWidth,MENU_BUTTON_MAX_WIDTH);menuButtonIconHeight=Math.min(menuButtonHeight,MENU_BUTTON_MAX_HEIGHT);menuButtonCalcWidth=_menuButtonsContainer.width/4;menuButtonCalcHeight=_menuButtonsContainer.height;}else{var menuWidth=_mobileUtils.convertRatio(MENU_MAX_HEIGHT,true);menuBorderSize=_mobileUtils.convertRatio(MENU_MAX_BORDER_SIZE,true);_menuBackground.setSize(Math.min(menuWidth,MENU_MAX_HEIGHT),stage.stageHeight);_menuBackground.setCSS("border","none");_menuBackground.setCSS("border-right","2px solid #FFFFFF");_menuBackground.setCSS("border-width",Math.min(menuBorderSize,MENU_MAX_BORDER_SIZE)+"px");var menuButtonsContainerHeight=_mobileUtils.convertRatio(MENU_BUTTONS_CONTAINER_MAX_WIDTH,true);_menuButtonsContainer.setSize(_menuBackground.width,Math.min(stage.stageHeight,Math.min(menuButtonsContainerHeight,MENU_BUTTONS_CONTAINER_MAX_WIDTH)));_menuButtonsContainer.move(0,(stage.stageHeight-_menuButtonsContainer.height)*0.5);menuButtonWidth=_mobileUtils.convertRatio(MENU_BUTTON_MAX_WIDTH,true);menuButtonHeight=_mobileUtils.convertRatio(MENU_BUTTON_MAX_HEIGHT,true);menuButtonIconWidth=Math.min(menuButtonWidth,MENU_BUTTON_MAX_WIDTH);menuButtonIconHeight=Math.min(menuButtonHeight,MENU_BUTTON_MAX_HEIGHT);menuButtonCalcWidth=_menuButtonsContainer.width;menuButtonCalcHeight=_menuButtonsContainer.height/4;};_caloriesButton.setSize(menuButtonCalcWidth,menuButtonCalcHeight);_statisticsButton.setSize(menuButtonCalcWidth,menuButtonCalcHeight);_foodListButton.setSize(menuButtonCalcWidth,menuButtonCalcHeight);_settingsButton.setSize(menuButtonCalcWidth,menuButtonCalcHeight);_caloriesButton.setCSS("background-size",menuButtonIconWidth+"px "+menuButtonIconHeight+"px");_statisticsButton.setCSS("background-size",menuButtonIconWidth+"px "+menuButtonIconHeight+"px");_foodListButton.setCSS("background-size",menuButtonIconWidth+"px "+menuButtonIconHeight+"px");_settingsButton.setCSS("background-size",menuButtonIconWidth+"px "+menuButtonIconHeight+"px");_caloriesButton.move(0,0);_statisticsButton.move(isPortrait?_caloriesButton.x+_caloriesButton.width:0,isPortrait?0:_caloriesButton.y+_caloriesButton.height);_foodListButton.move(isPortrait?_statisticsButton.x+_statisticsButton.width:0,isPortrait?0:_statisticsButton.y+_statisticsButton.height);_settingsButton.move(isPortrait?_foodListButton.x+_foodListButton.width:0,isPortrait?0:_foodListButton.y+_foodListButton.height);};(function(){that.setCSS("position","fixed");_menuBackground=new ASJS.DisplayObject();_menuBackground.addClass("menu_background");that.addChild(_menuBackground);_menuButtonsContainer=new ASJS.Sprite();that.addChild(_menuButtonsContainer);_caloriesButton=new ASJS.Button();_caloriesButton.addClass("menu_button_calories");_caloriesButton.setAttr("title",_language.getText("calories_button_label"));_caloriesButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(MenuMediator.ON_CALORIES_CLICK);});_menuButtonsContainer.addChild(_caloriesButton);_statisticsButton=new ASJS.Button();_statisticsButton.addClass("menu_button_statistics");_statisticsButton.setAttr("title",_language.getText("statistics_button_label"));_statisticsButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(MenuMediator.ON_STATISTICS_CLICK);});_menuButtonsContainer.addChild(_statisticsButton);_foodListButton=new ASJS.Button();_foodListButton.addClass("menu_button_food_list");_foodListButton.setAttr("title",_language.getText("food_list_button_label"));_foodListButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(MenuMediator.ON_FOOD_LIST_CLICK);});_menuButtonsContainer.addChild(_foodListButton);_settingsButton=new ASJS.Button();_settingsButton.addClass("menu_button_settings");_settingsButton.setAttr("title",_language.getText("settings_button_label"));_settingsButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(MenuMediator.ON_SETTINGS_CLICK);});_menuButtonsContainer.addChild(_settingsButton);})();return that;};MenuView.MENU_SIZE=102;function AbstractInAppView(){var that=new AbstractView();var _mobileUtils=new MobileUtils().instance;that._container;that.drawNow=function(){var isPortrait=_mobileUtils.getOrientation()==MobileUtils.ORIENTATION_PORTRAIT;var menuSize=Math.floor(_mobileUtils.convertRatio(MenuView.MENU_SIZE,true));var menuCalcSize=Math.min(menuSize,MenuView.MENU_SIZE);that._container.move(isPortrait?0:menuCalcSize,isPortrait?menuCalcSize:0);that._container.setSize(that.width-that._container.x,that.height-that._container.y);};(function(){that._container=new ASJS.Sprite();that.addChild(that._container);})();return that;};AbstractInAppView.MARGIN=20;AbstractInAppView.GAP=5;function AddButton(){var that=new ASJS.Button();var _mobileUtils=new MobileUtils().instance;var BUTTON_MAX_SIZE=90;that.drawNow=function(){var isPortrait=_mobileUtils.getOrientation()==MobileUtils.ORIENTATION_PORTRAIT;var originalHeight=that.height;var buttonSize=_mobileUtils.convertRatio(BUTTON_MAX_SIZE,true);var menuSize=Math.floor(_mobileUtils.convertRatio(MenuView.MENU_SIZE,true));var menuCalcSize=Math.min(menuSize,MenuView.MENU_SIZE);that.height=Math.min(buttonSize,BUTTON_MAX_SIZE);that.move(isPortrait?0:menuCalcSize,(isPortrait?menuCalcSize:0)+originalHeight-that.calcHeight);};(function(){that.setCSS("position","fixed");that.addClass("add_button");})();return that;};function CalorieListLabel(){var that=new Label();var _super={};var _mobileUtils=new MobileUtils().instance;var _sumCaloriesLabel;var _maxCalories;defineProperty(that,"sumCalories",{get:function(){return Number(_sumCaloriesLabel.text);},set:function(value){_sumCaloriesLabel.text=value;}});defineProperty(that,"maxCalories",{get:function(){return _maxCalories;},set:function(value){_maxCalories=value;}});extendFunction(_super,that,"drawNow");that.drawNow=function(){_super.drawNow();_sumCaloriesLabel.removeClass("calorie_list_label_good");_sumCaloriesLabel.removeClass("calorie_list_label_bad");_sumCaloriesLabel.addClass("calorie_list_label_"+(that.sumCalories<=that.maxCalories?"good":"bad"));_sumCaloriesLabel.setCSS("font-size",that._label.getCSS("font-size"));_sumCaloriesLabel.setCSS("line-height",that.height+"px");_sumCaloriesLabel.move(that._label.x,that._label.y);_sumCaloriesLabel.setSize(that._label.width+that._label.x*0.5,that._label.height);};(function(){_sumCaloriesLabel=new ASJS.Label();that.addChild(_sumCaloriesLabel);})();return that;};function CalorieListCell(){var that=new FoodListCell();var _super={};var _language=new Language().instance;var _timeLabel;that.showData=function(){var time=that.data.timestamp.split(" ");if(that.data.type==CalorieDataVo.TYPE_FOOD){that.title=time[1]+" "+that.data.foodData.name;that._icon.addClass(that.ICON_CLASSES[that.data.foodData.type]);that.calories=(that.data.foodData.type==2?"-":"")+that.data.foodData.calories+_language.getText("calorie_unit");}else{var date=new Date();var now=date.toYMD().split(". ").join("-").substr(0,10);_timeLabel.text=time[0]==now?_language.getText("today"):time[0];_timeLabel.sumCalories=that.data.sumCalories;_timeLabel.maxCalories=that.data.maxCalories;_timeLabel.drawNow();that.removeChild(that._box);that.addChild(_timeLabel);}};extendFunction(_super,that,"drawNow");that.drawNow=function(){_super.drawNow();if(that.contains(_timeLabel)){_timeLabel.move(0,0);_timeLabel.setSize(that.width,that.height);_timeLabel.drawNow();that.height=_timeLabel.calcHeight;}};(function(){_timeLabel=new CalorieListLabel();_timeLabel.icon="images/icons/calendar.png";})();return that;};function CalorieDataVo(value){var that={};var data=value||{};that.id=data["id"]||null;that.userId=data["user_id"]||null;that.timestamp=data["timestamp"]||new Data();that.foodData=new FoodDataVo(data["food_data"]);that.type=CalorieDataVo.TYPE_FOOD;that.sumCalories=0;that.maxCalories=0;return that;};CalorieDataVo.TYPE_FOOD="CalorieDataVo-typeFood";CalorieDataVo.TYPE_TIME="CalorieDataVo-typeTime";function CaloriesView(){var that=new AbstractInAppView();var _super={};var _language=new Language().instance;var _addButton;var _calorieList;var _calorieListData=[];var _dailyCalories=0;defineProperty(that,"dailyCalories",{get:function(){return _dailyCalories;},set:function(value){_dailyCalories=value;}});defineProperty(that,"calorieList",{get:function(){return _calorieListData;},set:function(value){var originalCalorieListData=value;_calorieListData=[];if(originalCalorieListData.length==0)return;var i;var l=originalCalorieListData.length;var calorieList=[];var calorieData;var timeStamp=0;var lastTimeStamp=0;var sumCalories=0;for(i=0;i<l;i++){calorieData=new CalorieDataVo(originalCalorieListData[i]);calorieData.type=CalorieDataVo.TYPE_FOOD;timeStamp=calorieData.timestamp.split(" ");if(i==0)lastTimeStamp=timeStamp[0];if(timeStamp[0]!=lastTimeStamp){_calorieListData.push(createTimeLabel(originalCalorieListData[i-1],sumCalories,that.dailyCalories));lastTimeStamp=timeStamp[0];sumCalories=0;};sumCalories+=(calorieData.foodData.type==2?-1:1)*Number(calorieData.foodData.calories);_calorieListData.push(calorieData);if(i==(l-1)){_calorieListData.push(createTimeLabel(originalCalorieListData[i],sumCalories,that.dailyCalories));}};_calorieListData.sort(function(a,b){if(a.timestamp>b.timestamp)return-1;if(a.timestamp<b.timestamp)return 1;return 0;});l=_calorieListData.length;for(i=0;i<l;i++){calorieList.push(_calorieListData[i]);};_calorieList.setList(calorieList);}});extendFunction(_super,that,"drawNow");that.drawNow=function(){_super.drawNow();_addButton.setSize(that._container.width,that._container.height);_addButton.drawNow();_calorieList.move(0,AbstractInAppView.GAP);_calorieList.width=that._container.width;_calorieList.drawNow();_calorieList.height=_calorieList.getChildAt(0).calcHeight+_addButton.height*2;};function createTimeLabel(data,sumCalories,maxCalories){var timeLabelData=new CalorieDataVo(data);timeLabelData.timestamp+=" ";timeLabelData.type=CalorieDataVo.TYPE_TIME;timeLabelData.sumCalories=sumCalories;timeLabelData.maxCalories=maxCalories;return timeLabelData;};function removedFromStage(){_calorieList.clearList();};(function(){that.addEventListener(ASJS.Stage.REMOVED_FROM_STAGE,removedFromStage);_calorieList=new ASJS.CustomList();_calorieList.cell=CalorieListCell;_calorieList.addEventListener(FoodListCell.DELETE,function(event,cell){if(!cell)return;that.dispatchEvent(CaloriesMediator.DELETE_ITEM,[cell.data]);});that._container.addChild(_calorieList);_addButton=new AddButton();_addButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(CaloriesMediator.ON_ADD_CLICK);});that._container.addChild(_addButton);})();return that;};function CaloriesMediator(view){var that=new ASJS.AbstractMediator(view);var _language=new Language().instance;var _services=new Services().instance;var _tools=new Tools().instance;var _caloriesView=new CaloriesView();that.handlers=[ASJS.Stage.RESIZE,CaloriesMediator.SHOW,CaloriesMediator.HIDE,AddCalorieEntryMediator.ENTRY_ADDED];that.reciveNotification=function(notificationType,data){switch(notificationType){case ASJS.Stage.RESIZE:onResize();break;case CaloriesMediator.SHOW:onShow();break;case CaloriesMediator.HIDE:onHide();break;case AddCalorieEntryMediator.ENTRY_ADDED:loadEntries();break;}};function onResize(){_caloriesView.setSize(stage.stageWidth,stage.stageHeight);_caloriesView.drawNow();};function onShow(){if(that.view.contains(_caloriesView))return;stage.window.scrollTop(0);that.view.addEventListener(CaloriesMediator.ON_ADD_CLICK,function(event){that.sendNotification(AddCalorieEntryMediator.SHOW);});that.view.addEventListener(CaloriesMediator.DELETE_ITEM,function(event,data){var notificationDataVo=new NotificationDataVo();notificationDataVo.title=_language.getText("notification_delete_title");notificationDataVo.content=_tools.replaceText(_language.getText("notification_delete_content"),data.foodData);notificationDataVo.showOk=true;notificationDataVo.showCancel=true;notificationDataVo.okCallback=function(){onDeleteItem(data);};that.sendNotification(NotificationMediator.SHOW,notificationDataVo);});that.view.addChild(_caloriesView);loadEntries();};function onDeleteItem(data){that.sendNotification(PreloaderMediator.SHOW);_services.deleteCalorieById(data.id,function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("success");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_SUCCESS;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);loadEntries();},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);});};function loadEntries(){if(!that.view.contains(_caloriesView))return;that.sendNotification(PreloaderMediator.SHOW);_services.getSettings(function(response){_caloriesView.dailyCalories=response["daily_calories"];_services.getCaloriesList(function(response){that.sendNotification(PreloaderMediator.HIDE);response.sort(function(a,b){if(a["timestamp"]<b["timestamp"])return-1;if(a["timestamp"]>b["timestamp"])return 1;return 0;});_caloriesView.calorieList=response;if(response.length==0){var notificationDataVo=new NotificationDataVo();notificationDataVo.title=_language.getText("notification_tip_title");notificationDataVo.content=_language.getText("notification_add_entry_content");notificationDataVo.showOk=true;that.sendNotification(NotificationMediator.SHOW,notificationDataVo);};onResize();},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);onResize();});},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("unknow_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);onResize();});};function onHide(){if(!that.view.contains(_caloriesView))return;that.view.removeEventListeners();that.view.removeChild(_caloriesView);};(function(){that.registerNotificationHandlers();})();return that;};CaloriesMediator.SHOW="CaloriesMediator-show";CaloriesMediator.HIDE="CaloriesMediator-hide";CaloriesMediator.ON_ADD_CLICK="CaloriesMediator-onAddClick";CaloriesMediator.DELETE_ITEM="CaloriesMediator-deleteItem";function LoginView(){var that=new AbstractView();var _language=new Language().instance;var _mobileUtils=new MobileUtils().instance;var LOGO_MAX_WIDTH=204;var LOGO_MAX_HEIGHT=258;var LOGO_MAX_Y=65;var LOGIN_BUTTON_MAX_Y=50;var _logo;var _loginButton;that.drawNow=function(){var logoWidth=_mobileUtils.convertRatio(LOGO_MAX_WIDTH,true);var logoHeight=_mobileUtils.convertRatio(LOGO_MAX_HEIGHT,true);var logoY=_mobileUtils.convertRatio(LOGO_MAX_Y,true);_logo.setSize(Math.min(logoWidth,LOGO_MAX_WIDTH),Math.min(logoHeight,LOGO_MAX_HEIGHT));_logo.move((that.width-_logo.width)*0.5,Math.min(logoY,LOGO_MAX_Y));var loginButtonY=_mobileUtils.convertRatio(LOGIN_BUTTON_MAX_Y,true);_loginButton.setSize(that.width,that.height);_loginButton.drawNow();_loginButton.move((that.width-_loginButton.calcWidth)*0.5,_logo.y+_logo.height+Math.min(loginButtonY,LOGIN_BUTTON_MAX_Y));};(function(){_logo=new ASJS.Sprite();_logo.addClass("logo");that.addChild(_logo);_loginButton=new Button();_loginButton.label=_language.getText("facebook_login_button_label");_loginButton.addEventListener(ASJS.MouseEvent.CLICK,function(event){that.dispatchEvent(LoginMediator.FACEBOOK_BUTTON_CLICK);});that.addChild(_loginButton);})();return that;};function LoggedInCommand(){var that=new ASJS.AbstractCommand();that.execute=function(){that.sendNotification(PreloaderMediator.SHOW);that.sendNotification(LoginMediator.HIDE);that.sendNotification(MenuMediator.SHOW);(new ShowCaloriesCommand()).execute();that.sendNotification(PreloaderMediator.HIDE);};return that;};function Facebook(){function FacebookInstance(){var that=new ASJS.NotificationDispatcher();var _fbRoot=new ASJS.Sprite();that.init=function(facebookAppId){var e=document.createElement('script');e.async=true;e.src=document.location.protocol+'//connect.facebook.net/en_US/all.js';document.getElementById('fb-root').appendChild(e);window.fbAsyncInit=function(){FB.init({appId:facebookAppId,status:true,cookie:true,xfbml:true,oauth:true,version:'v2.4'});FB.getLoginStatus(onLoginStatus);};};that.login=function(){FB.login(onLoginStatus);};that.logout=function(){FB.getLoginStatus(function(response){if(response.status=="connected"){FB.logout(function(response){that.sendNotification(Facebook.LOGOUT);});}else that.sendNotification(Facebook.LOGOUT);});};that.postToFeed=function(title,desc,url,imageUrl){var obj={method:'feed',link:url,picture:imageUrl,name:title,description:desc};function postFeedCallback(response){that.sendNotification(Facebook.POST_COMPLETE,response);};FB.ui(obj,postFeedCallback);};function onLoginStatus(response){switch(response.status){case"connected":that.sendNotification(Facebook.CONNECTED,response.authResponse);break;case"not_authorized":that.sendNotification(Facebook.NOT_AUTHORIZED);break;case"unknown":that.sendNotification(Facebook.UNKNOW);break;}};(function(){_fbRoot.setAttr("id","fb-root");stage.addChild(_fbRoot);})();return that;};defineProperty(this,"instance",{get:function(){if(!Facebook.$)Facebook.$=new FacebookInstance();return Facebook.$;}});};Facebook.CONNECTED="Facebook-connected";Facebook.NOT_AUTHORIZED="Facebook-notAuthorized";Facebook.UNKNOW="Facebook-unknow";Facebook.LOGOUT="Facebook-logout";Facebook.POST_COMPLETE="Facebook-postComplete";function LoginMediator(view){var that=new ASJS.AbstractMediator(view);var _language=new Language().instance;var _facebook=new Facebook().instance;var _config=new Config().instance;var _services=new Services().instance;var _loginView=new LoginView();that.handlers=[ASJS.Stage.RESIZE,LoginMediator.SHOW,LoginMediator.HIDE,Facebook.CONNECTED,Facebook.NOT_AUTHORIZED,Facebook.UNKNOW];that.reciveNotification=function(notificationType,data){switch(notificationType){case ASJS.Stage.RESIZE:onResize();break;case LoginMediator.SHOW:onShow();break;case LoginMediator.HIDE:onHide();break;case Facebook.CONNECTED:onFacebookConnected(data);break;case Facebook.NOT_AUTHORIZED:case Facebook.UNKNOW:that.sendNotification(PreloaderMediator.HIDE);break;}};function onResize(){_loginView.setSize(stage.stageWidth,stage.stageHeight);_loginView.drawNow();};function onFacebookConnected(data){_services.login(data,function(response){(new LoggedInCommand()).execute();that.sendNotification(PreloaderMediator.HIDE);},function(response){that.sendNotification(PreloaderMediator.HIDE);var quickNotificatonDataVo=new QuickNotificationDataVo();quickNotificatonDataVo.message=_language.getText("authentication_error");quickNotificatonDataVo.type=QuickNotificationMediator.TYPE_WARNING;that.sendNotification(QuickNotificationMediator.SHOW,quickNotificatonDataVo);});};function onShow(){if(that.view.contains(_loginView))return;stage.window.scrollTop(0);that.sendNotification(PreloaderMediator.SHOW);_facebook.init(_config.get("facebookAppId"));that.view.addEventListener(LoginMediator.FACEBOOK_BUTTON_CLICK,function(event){_facebook.login();});that.view.addChild(_loginView);onResize();};function onHide(){if(!that.view.contains(_loginView))return;that.view.removeEventListeners();that.view.removeChild(_loginView);};(function(){that.registerNotificationHandlers();})();return that;};LoginMediator.SHOW="LoginMediator-show";LoginMediator.HIDE="LoginMediator-hide";LoginMediator.FACEBOOK_BUTTON_CLICK="LoginMediator-facebookButtonClick";function ViewPrepCommand(){var that=new ASJS.AbstractCommand();var _language=new Language().instance;that.execute=function(app){new CaloriesMediator(app.caloriesView);new StatisticsMediator(app.statisticsView);new FoodListMediator(app.foodListView);new SettingsMediator(app.settingsView);new MenuMediator(app.menuView);new LoginMediator(app.loginView);new QuickNotificationMediator(app.quickNotificationView);new AddCalorieEntryMediator(app.addCalorieEntryView);new AddFoodEntryMediator(app.addFoodEntryView);new PreloaderMediator(app.preloaderView);var notificationMediator=new NotificationMediator(app.notificationView);notificationMediator.setDefault(_language.getText('notification_ok_button'),_language.getText('notification_cancel_button'));that.sendNotification(LoginMediator.SHOW);};return that;};function StartupCommand(){var that=new ASJS.AbstractCommand();that.execute=function(app){(new ConfigLoaderCommand()).execute().done(function(){(new LanguageLoaderCommand()).execute().done(function(){(new EnvironmentCommand()).execute();(new ViewPrepCommand()).execute(app);});});};return that;};function Application(){var that={};var _caloriesView=new ASJS.Sprite();var _statisticsView=new ASJS.Sprite();var _foodListView=new ASJS.Sprite();var _settingsView=new ASJS.Sprite();var _menuView=new ASJS.Sprite();var _loginView=new ASJS.Sprite();var _quickNotificationView=new ASJS.Sprite();var _addCalorieEntryView=new ASJS.Sprite();var _addFoodEntryView=new ASJS.Sprite();var _preloaderView=new ASJS.Sprite();var _notificationView=new ASJS.Sprite();defineProperty(that,"caloriesView",{get:function(){return _caloriesView;}});defineProperty(that,"statisticsView",{get:function(){return _statisticsView;}});defineProperty(that,"foodListView",{get:function(){return _foodListView;}});defineProperty(that,"settingsView",{get:function(){return _settingsView;}});defineProperty(that,"menuView",{get:function(){return _menuView;}});defineProperty(that,"loginView",{get:function(){return _loginView;}});defineProperty(that,"quickNotificationView",{get:function(){return _quickNotificationView;}});defineProperty(that,"addCalorieEntryView",{get:function(){return _addCalorieEntryView;}});defineProperty(that,"addFoodEntryView",{get:function(){return _addFoodEntryView;}});defineProperty(that,"preloaderView",{get:function(){return _preloaderView;}});defineProperty(that,"notificationView",{get:function(){return _notificationView;}});(function(){console.log("Lab.coop probafeladat");stage.addChild(_caloriesView);stage.addChild(_statisticsView);stage.addChild(_foodListView);stage.addChild(_settingsView);stage.addChild(_menuView);stage.addChild(_addCalorieEntryView);stage.addChild(_addFoodEntryView);stage.addChild(_loginView);stage.addChild(_quickNotificationView);stage.addChild(_preloaderView);stage.addChild(_notificationView);(new StartupCommand()).execute(that);})();return that;};ASJS.startASJS(Application);